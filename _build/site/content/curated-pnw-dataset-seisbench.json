{"version":3,"kind":"Notebook","sha256":"910129a11344960e9c46edefb4ec6cb38a2c9f02327626762a1e7aad627eb663","slug":"curated-pnw-dataset-seisbench","location":"/notebooks/niyiyu/curated_pnw_dataset_seisbench.ipynb","dependencies":[],"frontmatter":{"title":"üöÄ Access curated PNW Dataset with SeisBench APIs","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Amanda M. Thomas, William Marfo, and Lo√Øc Bachelot","name":"Amanda M. Thomas, William Marfo, and Lo√Øc Bachelot"}],"keywords":["earthquake","catalog","ML","AI"],"numbering":{"title":{"offset":2}},"thumbnail":"/41ad45c2b91bcf93cad0c8bb17b77df7.png","exports":[{"format":"ipynb","filename":"curated_pnw_dataset_seisbench.ipynb","url":"/curated_pnw_dataset_-6d6bc62472858f43787fbe3a253c248a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/41ad45c2b91bcf93cad0c8bb17b77df7.png","alt":"image","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IG23xi9e5I","urlSource":"https://github.com/niyiyu/PNW-ML/blob/main/figures/README_overview.png?raw=true"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"M5PGTAZdgD"}],"key":"FgBMXAcRvo"},{"type":"text","value":" Yiyu Ni","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Latm7MVTSu"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ku9AEiyvLF"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Goal:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RVME62KIXY"}],"key":"qFETpR2AR8"},{"type":"text","value":" This notebook first demonstrates how to request USGS ComCat and get waveforms. Then we demostrate access the curated PNW seismic dataset with SeisBench APIs.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jO9KkYbevc"}],"key":"OQeCWu3nHl"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fozmTk99B2"}],"key":"bMuTjMe5lS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport obspy\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seisbench.data as sbd\nimport seisbench.generate as sbg","key":"f74miaffqu"},{"type":"outputs","id":"gZxHrd7Vg5ijThoBOxOZZ","children":[],"key":"sFjIhP9D2E"}],"key":"GhBkpobgbj"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S5QYSSGEQX"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"1. Requst data: USGS earthquake catalog (ComCat)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EUBeFqjG2O"}],"identifier":"id-1-requst-data-usgs-earthquake-catalog-comcat","label":"1. Requst data: USGS earthquake catalog (ComCat)","html_id":"id-1-requst-data-usgs-earthquake-catalog-comcat","implicit":true,"key":"LN99eL6B1s"}],"key":"EesbZQSLHq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We start with requesting catalogs from USGS. We can do that though USGS‚Äôs ComCat web service (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IBR26FWyx9"},{"type":"link","url":"https://earthquake.usgs.gov/earthquakes/search/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://‚Äãearthquake‚Äã.usgs‚Äã.gov‚Äã/earthquakes‚Äã/search/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dxOZlEWm4U"}],"urlSource":"https://earthquake.usgs.gov/earthquakes/search/","key":"m1QyE7xbAb"},{"type":"text","value":"), but here let‚Äôs query the catalog using USGS‚Äôs FDSN service through obspy. By creating an obspy FDSN client, we can query event information using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VAZqqZZACL"},{"type":"link","url":"https://docs.obspy.org/packages/autogen/obspy.clients.fdsn.client.Client.get_events.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"client.get_events()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HFRsYUDIdq"}],"urlSource":"https://docs.obspy.org/packages/autogen/obspy.clients.fdsn.client.Client.get_events.html","key":"vezXJsGUqo"},{"type":"text","value":" function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BizPkaSwYc"}],"key":"ovJa7UAQ92"}],"key":"a96rVdIImD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client_usgs = obspy.clients.fdsn.Client(\"USGS\")\n\nevents = client_usgs.get_events(minlatitude=43, \n                                maxlatitude=45,\n                                minlongitude=-130, \n                                maxlongitude=-116,\n                                minmagnitude=3.0,\n                                starttime=obspy.UTCDateTime(\"2020-01-01\"),\n                                endtime=obspy.UTCDateTime(\"2025-01-01\"),\n                                contributor=\"uw\")\nprint(events)","key":"qDGxWJWwNB"},{"type":"outputs","id":"-Q-uw8ISfU-U3uETRYm9J","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"7 Event(s) in Catalog:\n2023-11-10T20:33:49.570000Z | +44.404, -124.579 | 3.06 ml | manual\n2023-04-24T11:42:58.970000Z | +43.492, -127.558 | 3.2  ml | manual\n2023-03-08T09:33:06.030000Z | +44.739, -117.270 | 3.03 ml | manual\n2022-10-07T12:52:36.010000Z | +44.540, -122.551 | 4.39 ml | manual\n2020-09-25T04:26:07.118000Z | +43.397, -127.084 | 3.3  ml | manual\n2020-07-21T23:39:16.430000Z | +44.993, -123.842 | 3.17 ml | manual\n2020-03-08T06:54:26.188000Z | +43.258, -126.964 | 3.0  ml | manual\n"},"children":[],"key":"Y6QHNkW8pW"}],"key":"sFZ8Pqo2dX"}],"key":"XaGER3xq6p"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We received events with their ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VIj1XLbCTz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"event ID, origins, magnitudes, and other metadata.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O0tHpjVOXD"}],"key":"uiVmvZdCQm"}],"key":"vBWKkkH0eZ"}],"key":"D6ZgcFDbKx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(events[0])","key":"ZvZQ71ybeP"},{"type":"outputs","id":"QPQfV-gVLc56RlF8u71nd","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Event:\t2023-11-10T20:33:49.570000Z | +44.404, -124.579 | 3.06 ml | manual\n\n\t            resource_id: ResourceIdentifier(id=\"quakeml:earthquake.usgs.gov/fdsnws/event/1/query?eventid=uw61971621&format=quakeml\")\n\t             event_type: 'earthquake'\n\t          creation_info: CreationInfo(agency_id='uw', creation_time=UTCDateTime(2024, 5, 10, 23, 15, 7, 800000), version='4')\n\t    preferred_origin_id: ResourceIdentifier(id=\"quakeml:earthquake.usgs.gov/product/origin/uw61971621/uw/1715382907800/product.xml\")\n\t preferred_magnitude_id: ResourceIdentifier(id=\"quakeml:earthquake.usgs.gov/product/origin/uw61971621/uw/1715382907800/product.xml#magnitude\")\n\t                   ---------\n\t     event_descriptions: 1 Elements\n\t                origins: 1 Elements\n\t             magnitudes: 1 Elements\n"},"children":[],"key":"NNihEZ08f5"}],"key":"HWriyfIvIJ"}],"key":"KR9Qc5oOoC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can also going to the USGS event page using the event id.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SCwpGfVco5"}],"key":"E29nBN7RYt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"‚¨áÔ∏è‚¨áÔ∏è","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"csuLzEs19t"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Click the link generated by the cell below","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FkpXPCzkBq"}],"key":"SYyUGuPxPw"},{"type":"text","value":"‚¨áÔ∏è‚¨áÔ∏è","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TvLaDp4sgV"}],"key":"ZSFKX3ViCm"}],"key":"FHxl466krc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"eid = events[0].preferred_origin_id.id.split(\"/\")[3]\nprint(f\"https://earthquake.usgs.gov/earthquakes/eventpage/{eid}/executive\")","key":"qeNAHHuPjI"},{"type":"outputs","id":"gHaARFMPRQw61ftmyZyKD","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"https://earthquake.usgs.gov/earthquakes/eventpage/uw61971621/executive\n"},"children":[],"key":"wZ6KgSn7V5"}],"key":"LO53A7G8Re"}],"key":"qtoCONygik"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"One would notice that the event above contains ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eyqSNnH9nJ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"no phase arrival information","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ixHaNmZaWD"}],"key":"eIxOMOMrXt"},{"type":"text","value":". This is because requesting the arrival information is not supported yet by the USGS FDSN service (otherwise we could add a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cyEY0wCKhD"},{"type":"inlineCode","value":"includearrivals=True","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NHt3d3IHQe"},{"type":"text","value":" to the query above).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RCERJ5OwkR"}],"key":"ZCgBwi6aKH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To retrieve the phase arrival information, we need to extract them from the raw QuakeXML file, which ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SbgSP0mJgp"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"contains ALL metadata for this event","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sxiKEHyDeG"}],"key":"Vj5TwxN698"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uJkJjgbK2j"}],"key":"E0eEYNBVM7"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"‚¨áÔ∏è‚¨áÔ∏èClick the link generated by the cell below.‚¨áÔ∏è‚¨áÔ∏è","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vVjLOgJgyk"}],"key":"o0cs2Lxspu"}],"key":"RZG9X3lYma"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"quakexml = f\"https://earthquake.usgs.gov/fdsnws/event/1/query?eventid={eid}&format=quakeml\"\nprint(quakexml)","key":"eVpW9lmcSU"},{"type":"outputs","id":"Nk3eEmfDSTtQIXPbb5JAd","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"https://earthquake.usgs.gov/fdsnws/event/1/query?eventid=uw61971621&format=quakeml\n"},"children":[],"key":"tPW8EGxpTQ"}],"key":"SO2mQYaLfP"}],"key":"ZUUAzIQHAi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can load the QuakeXML file directly using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aXuOOZIH3S"},{"type":"link","url":"https://docs.obspy.org/packages/autogen/obspy.core.event.read_events.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"obspy.read_events()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KQpIPwwagF"}],"urlSource":"https://docs.obspy.org/packages/autogen/obspy.core.event.read_events.html","key":"hGzzkKr8zL"},{"type":"text","value":" function, which similarly returns an event object. But this time, we see a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pOAhw7uaub"},{"type":"inlineCode","value":"picks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GWApqrfQOI"},{"type":"text","value":" field, which contains a list of picks for this event.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rd4YXrWoZQ"}],"key":"QLue23SzDm"}],"key":"YiLDIB0YK2"},{"type":"block","kind":"notebook-code","data":{"scrolled":false},"children":[{"type":"code","lang":"python","executable":true,"value":"event = obspy.read_events(quakexml)[0]\n\n# show the first 10 picks\nfor p in event.picks[:10]:\n    print(\"-\"*100)\n    print(p)","key":"oiGXtJSUcU"},{"type":"outputs","id":"r10HCLdfe7q0ds8HnHIDW","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714543\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 33, 58, 320000) [uncertainty=0.06]\n\t       waveform_id: WaveformStreamID(network_code='UW', station_code='ONAB', channel_code='HNZ', location_code='')\n\t             onset: 'impulsive'\n\t          polarity: 'negative'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714548\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 5, 360000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='UW', station_code='ONAB', channel_code='HNN', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714568\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 6, 520000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='OO', station_code='HYS12', channel_code='EHN', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714588\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 6, 570000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='OO', station_code='HYS11', channel_code='EHN', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714593\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 8, 120000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='UO', station_code='TDWTR', channel_code='HHE', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714598\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 0, 140000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='UO', station_code='OTTR', channel_code='HNZ', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714603\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 8, 890000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='UO', station_code='OTTR', channel_code='HNN', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714608\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 0, 430000) [uncertainty=0.06]\n\t       waveform_id: WaveformStreamID(network_code='UW', station_code='TOLO', channel_code='ENZ', location_code='')\n\t             onset: 'impulsive'\n\t          polarity: 'positive'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714613\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 9, 220000) [uncertainty=0.15]\n\t       waveform_id: WaveformStreamID(network_code='UW', station_code='TOLO', channel_code='ENN', location_code='')\n\t             onset: 'emergent'\n\t          polarity: 'undecidable'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n----------------------------------------------------------------------------------------------------\nPick\n\t       resource_id: ResourceIdentifier(id=\"quakeml:uw.anss.org/Arrival/UW/16714618\")\n\t              time: UTCDateTime(2023, 11, 10, 20, 34, 0, 910000) [uncertainty=0.06]\n\t       waveform_id: WaveformStreamID(network_code='UO', station_code='DEPO', channel_code='HNZ', location_code='')\n\t             onset: 'impulsive'\n\t          polarity: 'positive'\n\t   evaluation_mode: 'manual'\n\t evaluation_status: 'reviewed'\n\t     creation_info: CreationInfo(agency_id='UW', creation_time=UTCDateTime(2023, 11, 10, 21, 10, 58))\n"},"children":[],"key":"QYWG5MKAF0"}],"key":"SsxAXlyJoY"}],"key":"bQZhedJvIC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can also try to plot the waveforms for this event. To do that, we create another FDSN client for IRIS (or renamed as EarthScope now). Then we request waveforms for the first ten picks from the above event.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T9SKHBdSHM"}],"key":"T2yZh8kSJZ"}],"key":"xDteKNf2hv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client_iris = obspy.clients.fdsn.Client(\"IRIS\")","key":"orymlKXulX"},{"type":"outputs","id":"vHN47ZitSwHV_EOMBbo8L","children":[],"key":"AW3R8lsk7j"}],"key":"YLRoUbD2qS"},{"type":"block","kind":"notebook-code","data":{"scrolled":false},"children":[{"type":"code","lang":"python","executable":true,"value":"for pk in event.picks[:10]:\n    ptime = pk.time\n    net = pk.waveform_id.network_code\n    sta = pk.waveform_id.station_code\n    loc = pk.waveform_id.location_code\n    cha = pk.waveform_id.channel_code\n\n    s = client_iris.get_waveforms(network=net, station=sta, location=loc, channel=cha,\n                                  starttime=ptime-30, endtime=ptime+30) # get 60-second waveform\n    s.plot();","key":"ADmGAM0s3N"},{"type":"outputs","id":"ewdoz2AiGKo1KLEphRqvQ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a535f796de1432677cff828b27e5dc6","path":"/9a535f796de1432677cff828b27e5dc6.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"qT8Z5t5Sla"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3915d762b14e3dc773c16c1bae77a545","path":"/3915d762b14e3dc773c16c1bae77a545.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"VQkqSa0kGr"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f23ddb1bfc0243aaca2903f0197f9651","path":"/f23ddb1bfc0243aaca2903f0197f9651.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"PhjNXttbmb"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3e22c0895c1b52a6d3c30ebd21a2f266","path":"/3e22c0895c1b52a6d3c30ebd21a2f266.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"M1DOVj4OQj"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1ae5e6eedc92e36fc77676c71919d828","path":"/1ae5e6eedc92e36fc77676c71919d828.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"UZD6TySZTF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"649602573db3561895ef880d613c0102","path":"/649602573db3561895ef880d613c0102.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ub6PECS9ig"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7f5a598a2ed4e794ca55d3c9b279c458","path":"/7f5a598a2ed4e794ca55d3c9b279c458.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Vx74ZtSKwF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e2647a6517067f641425c258e3d44338","path":"/e2647a6517067f641425c258e3d44338.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ECEh8K3fQl"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d8303e2e0c7f15705a1471c640577bcf","path":"/d8303e2e0c7f15705a1471c640577bcf.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"lCHSfKBqSG"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e039da18d9bc3dcf3e29e6528c5494e","path":"/7e039da18d9bc3dcf3e29e6528c5494e.png"},"text/plain":{"content":"<Figure size 800x250 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"KPTGbzqECF"}],"key":"kFbjse10RV"}],"key":"zsvMHfFPAF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"‚úèÔ∏è Exercise","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OJDKSHuo7J"}],"identifier":"id-exercise","label":"‚úèÔ∏è Exercise","html_id":"id-exercise","implicit":true,"key":"elTGT3Saq3"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pick one event that you are interested (not necessarily from PNW). Get its event ID and check its event page.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tT1T6jiKT2"}],"key":"RE4koFlMa2"}],"key":"KI7FVi4x3P"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Query it from USGS ComCat using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UCeP1FO2BC"},{"type":"inlineCode","value":"obspy.get_events()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AQb3z2ZdBz"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qL8QL7mhyK"}],"key":"BEM8gnrd5L"}],"key":"HvQps9yNLa"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get its phase arrival information by reading its QuakeXML file using ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Co4NhM3efm"},{"type":"inlineCode","value":"obspy.read_events()","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"F1maaUrsZa"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hX0xtvVgns"}],"key":"QIIZ5h2PB7"}],"key":"kSQyakR0LU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get waveforms make plots for its phase picks using ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Mnkaez5QLf"},{"type":"inlineCode","value":"client_iris.get_waveforms()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZOLyZ5atKN"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qUIQ6YuioT"}],"key":"Ir7eDS4ncn"}],"key":"rIU7SJsQrk"}],"key":"kdVBV7jNRO"}],"key":"Wse4K6ZHKm"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OMAfECJpy5"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"2. Use the curated PNW dataset with SeisBench API","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vrzNpR7FDv"}],"identifier":"id-2-use-the-curated-pnw-dataset-with-seisbench-api","label":"2. Use the curated PNW dataset with SeisBench API","html_id":"id-2-use-the-curated-pnw-dataset-with-seisbench-api","implicit":true,"key":"mCrgF1bbMI"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The PNW dataset is made by the waveform file (in ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v4u8eAxTKE"},{"type":"inlineCode","value":"hdf5","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"E3Hc4ZNtW6"},{"type":"text","value":" format, sometime also called ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HYDvmwek6l"},{"type":"inlineCode","value":"h5","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X8Ia7nyM6A"},{"type":"text","value":") and the perspective metadata file (in ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"saW7fwfZPz"},{"type":"inlineCode","value":"csv","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oMghItuDzK"},{"type":"text","value":" format). See the structure in the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tDw4bwKCj5"},{"type":"inlineCode","value":"data/pnwml","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wmPwk1S25U"},{"type":"text","value":" folder with two small datasets (i.e., ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"SQu1yXLMhh"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"miniPNW","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DV4wt5bpp9"}],"key":"yOcH7Xf5mt"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PErvvQZelN"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"mesoPNW","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gcdKZSS5PV"}],"key":"LER3nHvWeT"},{"type":"text","value":").","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WsuFqaritS"}],"key":"z8vDYcncOQ"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"üöÄ Read more about SeisBench data format: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qd383sVGWL"},{"type":"link","url":"https://seisbench.readthedocs.io/en/stable/pages/data_format.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://‚Äãseisbench‚Äã.readthedocs‚Äã.io‚Äã/en‚Äã/stable‚Äã/pages‚Äã/data‚Äã_format‚Äã.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hkzfH87Kex"}],"urlSource":"https://seisbench.readthedocs.io/en/stable/pages/data_format.html","key":"CaZYyyxIqQ"}],"key":"NziuxX30nH"}],"key":"NU5UY2DJyE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# replace the path with where your dataset is\n! tree -lh ../data/pnwml","key":"xXF4FUR2Gb"},{"type":"outputs","id":"gIMNsuocsopIIHIJYfvw-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[ 160]  \u001b[1;36m../data/pnwml\u001b[0m\r\n‚îú‚îÄ‚îÄ [ 128]  \u001b[1;36mmesoPNW\u001b[0m\r\n‚îÇ¬†¬† ‚îú‚îÄ‚îÄ [4.7M]  metadata.csv\r\n‚îÇ¬†¬† ‚îî‚îÄ‚îÄ [6.3G]  waveforms.hdf5\r\n‚îî‚îÄ‚îÄ [ 160]  \u001b[1;36mminiPNW\u001b[0m\r\n    ‚îú‚îÄ‚îÄ [424K]  metadata.csv\r\n    ‚îî‚îÄ‚îÄ [640M]  waveforms.hdf5\r\n\r\n2 directories, 4 files\r\n"},"children":[],"key":"xHxyh0bmQf"}],"key":"fa4AUTAyzc"}],"key":"XLKMucbhwd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BH8EoB6DXo"},{"type":"inlineCode","value":"waveforms.hdf5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W7kWuDDpWe"},{"type":"text","value":" contains arrays of seismograms. We can see arrays are grouped into 10 buckets. The file also contains very few metadata like the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HnviL4WHdH"},{"type":"inlineCode","value":"component_order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wp6MLPw23H"},{"type":"text","value":" for three-component seismogram.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DW8TMnxi8D"}],"key":"lzyvgRi0N3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mF2BMQlUzC"},{"type":"inlineCode","value":"h5dump","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w1zix8Y1QT"},{"type":"text","value":" is a useful tool to check the hierarchical structure of this HDF5 file.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KvD7sxDi6F"}],"key":"o0XiquOo0p"}],"key":"MSDkZOkLyg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# replace the path with where your dataset is\n! h5dump -n ../data/pnwml/mesoPNW/waveforms.hdf5","key":"rJrtr35xi5"},{"type":"outputs","id":"hTX9RdjcXMUq7Vl53XTb6","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"HDF5 \"../data/pnwml/mesoPNW/waveforms.hdf5\" {\r\nFILE_CONTENTS {\r\n group      /\r\n group      /data\r\n dataset    /data/bucket1\r\n dataset    /data/bucket10\r\n dataset    /data/bucket2\r\n dataset    /data/bucket3\r\n dataset    /data/bucket4\r\n dataset    /data/bucket5\r\n dataset    /data/bucket6\r\n dataset    /data/bucket7\r\n dataset    /data/bucket8\r\n dataset    /data/bucket9\r\n group      /data_format\r\n dataset    /data_format/component_order\r\n }\r\n}\r\n"},"children":[],"key":"HEem46hFbP"}],"key":"ooCvfchnIy"}],"key":"PB87IP79xz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MhwRnl9ua9"},{"type":"inlineCode","value":"metadata.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DyihSkoQ7m"},{"type":"text","value":" represents a table of metadata for each data sample. It also documents where to locate the waveform. We will have a better view of this table later.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RiTDxxbSeB"}],"key":"ufployA1wW"}],"key":"UrfAVsAKSL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# replace the path with where your dataset is\n! head -n 5 ../data/pnwml/mesoPNW/metadata.csv","key":"kAGdfJVxrA"},{"type":"outputs","id":"MJRfUqRoR2LW4zXF_lM2R","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"event_id,source_origin_time,source_latitude_deg,source_longitude_deg,source_type,source_depth_km,preferred_source_magnitude,preferred_source_magnitude_type,preferred_source_magnitude_uncertainty,source_depth_uncertainty_km,source_horizontal_uncertainty_km,station_network_code,station_channel_code,station_code,station_location_code,station_latitude_deg,station_longitude_deg,station_elevation_m,trace_name,trace_sampling_rate_hz,trace_start_time,trace_S_arrival_sample,trace_P_arrival_sample,trace_S_arrival_uncertainty_s,trace_P_arrival_uncertainty_s,trace_P_polarity,trace_S_onset,trace_P_onset,trace_snr_db,source_type_pnsn_label,source_local_magnitude,source_local_magnitude_uncertainty,source_duration_magnitude,source_duration_magnitude_uncertainty,source_hand_magnitude,trace_missing_channel,trace_has_offset,bucket,tindex\r\nuw10564613,2002-10-03T01:56:49.530000Z,48.553,-122.52,earthquake,14.907,2.1,md,0.03,1.68,0.694,UW,BH,GNW,--,47.564,-122.825,220.0,\"bucket4$0,:3,:15001\",100,2002-10-03T01:55:59.530000Z,8097,6733,0.04,0.02,undecidable,,,6.135|3.065|11.766,eq,,,2.1,0.03,,0,1,4,0\r\nuw10564613,2002-10-03T01:56:49.530000Z,48.553,-122.52,earthquake,14.907,2.1,md,0.03,1.68,0.694,UW,EH,RPW,--,48.448,-121.515,850.0,\"bucket9$0,:3,:15001\",100,2002-10-03T01:55:59.530000Z,7258,6238,0.04,0.01,undecidable,,,nan|nan|22.583,eq,,,2.1,0.03,,2,0,9,0\r\nuw10564613,2002-10-03T01:56:49.530000Z,48.553,-122.52,earthquake,14.907,2.1,md,0.03,1.68,0.694,UW,BH,SQM,--,48.074,-123.048,45.0,\"bucket4$1,:3,:15001\",100,2002-10-03T01:55:59.530000Z,7037,6113,0.08,0.04,undecidable,,,1.756|3.057|3.551,eq,,,2.1,0.03,,0,1,4,1\r\nuw10564613,2002-10-03T01:56:49.530000Z,48.553,-122.52,earthquake,14.907,2.1,md,0.03,1.68,0.694,UW,EH,MCW,--,48.679,-122.833,693.0,\"bucket7$0,:3,:15001\",100,2002-10-03T01:55:59.530000Z,5894,5442,0.04,0.01,negative,,,nan|nan|27.185,eq,,,2.1,0.03,,2,0,7,0\r\n"},"children":[],"key":"SLHkiWcjta"}],"key":"v1XPQpRshd"}],"key":"xYK1jGcJjg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can load the dataset using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r4R2CBIvMw"},{"type":"inlineCode","value":"seisbench.data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oQZwvPah35"},{"type":"text","value":" as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UoLFLksUUv"},{"type":"inlineCode","value":"WaveformDataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oLeZyj9te2"},{"type":"text","value":" class.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OHDNTJyUPf"}],"key":"xPPBInGiT2"}],"key":"OExH6buey5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# replace the path with where your dataset is\ndataset = sbd.WaveformDataset(\"../data/pnwml/mesoPNW/\", component_order=\"ENZ\")\n\nprint(f\"The dataset contains {len(dataset)} samples.\")","key":"du0Lsgrzwf"},{"type":"outputs","id":"5AzrN53VoNr3nlnuNY5Da","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-05-11 22:27:07,442 | seisbench | WARNING | Dimension order not specified in data set. Assuming CW.\n"},"children":[],"key":"sVuiHQdAxg"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"The dataset contains 18640 samples.\n"},"children":[],"key":"hZx9FkWjT1"}],"key":"WDPBBzdzZJ"}],"key":"Cl24HUwgMr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let‚Äôs make the plot of the PNW dataset: events and stations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dab4rTpOUZ"}],"key":"gShFA6owf6"}],"key":"jbH7QqKnHz"},{"type":"block","kind":"notebook-code","data":{"scrolled":false},"children":[{"type":"code","lang":"python","executable":true,"value":"dataset.plot_map();","key":"KxljuIgDoL"},{"type":"outputs","id":"PyFFnnjywRDKKSiyBt0lz","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3bc81f020cb9d295975b6a7086221d8d","path":"/3bc81f020cb9d295975b6a7086221d8d.png"},"text/plain":{"content":"<Figure size 1500x1000 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"GkiFx0OKRt"}],"key":"IYZBefSzmw"}],"key":"ymNQJdTRzx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The metadata can be accessed by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L33nF40Wl3"},{"type":"inlineCode","value":".metadata","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sNF4mCHGfU"},{"type":"text","value":" attribute of the dataset as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MFj3n3CHDp"},{"type":"inlineCode","value":"pd.DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tMAF6I298V"},{"type":"text","value":" object. Each row here represents one sample (one 3C waveforms).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iL41FJdo9V"}],"key":"NfpYGA3yy0"}],"key":"gIj8fFZkzC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pd.set_option('display.max_columns', None) # show all columns\nmeta = dataset.metadata\nmeta.head()","key":"l6TSI8FCSj"},{"type":"outputs","id":"eHoLfmIlKslukqpE7JJDK","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>index</th>\n      <th>event_id</th>\n      <th>source_origin_time</th>\n      <th>source_latitude_deg</th>\n      <th>source_longitude_deg</th>\n      <th>source_type</th>\n      <th>source_depth_km</th>\n      <th>preferred_source_magnitude</th>\n      <th>preferred_source_magnitude_type</th>\n      <th>preferred_source_magnitude_uncertainty</th>\n      <th>source_depth_uncertainty_km</th>\n      <th>source_horizontal_uncertainty_km</th>\n      <th>station_network_code</th>\n      <th>station_channel_code</th>\n      <th>station_code</th>\n      <th>station_location_code</th>\n      <th>station_latitude_deg</th>\n      <th>station_longitude_deg</th>\n      <th>station_elevation_m</th>\n      <th>trace_name</th>\n      <th>trace_sampling_rate_hz</th>\n      <th>trace_start_time</th>\n      <th>trace_S_arrival_sample</th>\n      <th>trace_P_arrival_sample</th>\n      <th>trace_S_arrival_uncertainty_s</th>\n      <th>trace_P_arrival_uncertainty_s</th>\n      <th>trace_P_polarity</th>\n      <th>trace_S_onset</th>\n      <th>trace_P_onset</th>\n      <th>trace_snr_db</th>\n      <th>source_type_pnsn_label</th>\n      <th>source_local_magnitude</th>\n      <th>source_local_magnitude_uncertainty</th>\n      <th>source_duration_magnitude</th>\n      <th>source_duration_magnitude_uncertainty</th>\n      <th>source_hand_magnitude</th>\n      <th>trace_missing_channel</th>\n      <th>trace_has_offset</th>\n      <th>bucket</th>\n      <th>tindex</th>\n      <th>trace_chunk</th>\n      <th>trace_component_order</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>uw10564613</td>\n      <td>2002-10-03T01:56:49.530000Z</td>\n      <td>48.553</td>\n      <td>-122.520</td>\n      <td>earthquake</td>\n      <td>14.907</td>\n      <td>2.1</td>\n      <td>md</td>\n      <td>0.03</td>\n      <td>1.68</td>\n      <td>0.694</td>\n      <td>UW</td>\n      <td>BH</td>\n      <td>GNW</td>\n      <td>--</td>\n      <td>47.564</td>\n      <td>-122.825</td>\n      <td>220.0</td>\n      <td>bucket4$0,:3,:15001</td>\n      <td>100.0</td>\n      <td>2002-10-03T01:55:59.530000Z</td>\n      <td>8097</td>\n      <td>6733</td>\n      <td>0.04</td>\n      <td>0.02</td>\n      <td>undecidable</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>6.135|3.065|11.766</td>\n      <td>eq</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2.1</td>\n      <td>0.03</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>1</td>\n      <td>4</td>\n      <td>0</td>\n      <td></td>\n      <td>ENZ</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>uw10564613</td>\n      <td>2002-10-03T01:56:49.530000Z</td>\n      <td>48.553</td>\n      <td>-122.520</td>\n      <td>earthquake</td>\n      <td>14.907</td>\n      <td>2.1</td>\n      <td>md</td>\n      <td>0.03</td>\n      <td>1.68</td>\n      <td>0.694</td>\n      <td>UW</td>\n      <td>EH</td>\n      <td>RPW</td>\n      <td>--</td>\n      <td>48.448</td>\n      <td>-121.515</td>\n      <td>850.0</td>\n      <td>bucket9$0,:3,:15001</td>\n      <td>100.0</td>\n      <td>2002-10-03T01:55:59.530000Z</td>\n      <td>7258</td>\n      <td>6238</td>\n      <td>0.04</td>\n      <td>0.01</td>\n      <td>undecidable</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>nan|nan|22.583</td>\n      <td>eq</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2.1</td>\n      <td>0.03</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>0</td>\n      <td>9</td>\n      <td>0</td>\n      <td></td>\n      <td>ENZ</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>uw10564613</td>\n      <td>2002-10-03T01:56:49.530000Z</td>\n      <td>48.553</td>\n      <td>-122.520</td>\n      <td>earthquake</td>\n      <td>14.907</td>\n      <td>2.1</td>\n      <td>md</td>\n      <td>0.03</td>\n      <td>1.68</td>\n      <td>0.694</td>\n      <td>UW</td>\n      <td>BH</td>\n      <td>SQM</td>\n      <td>--</td>\n      <td>48.074</td>\n      <td>-123.048</td>\n      <td>45.0</td>\n      <td>bucket4$1,:3,:15001</td>\n      <td>100.0</td>\n      <td>2002-10-03T01:55:59.530000Z</td>\n      <td>7037</td>\n      <td>6113</td>\n      <td>0.08</td>\n      <td>0.04</td>\n      <td>undecidable</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.756|3.057|3.551</td>\n      <td>eq</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2.1</td>\n      <td>0.03</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>1</td>\n      <td>4</td>\n      <td>1</td>\n      <td></td>\n      <td>ENZ</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>uw10564613</td>\n      <td>2002-10-03T01:56:49.530000Z</td>\n      <td>48.553</td>\n      <td>-122.520</td>\n      <td>earthquake</td>\n      <td>14.907</td>\n      <td>2.1</td>\n      <td>md</td>\n      <td>0.03</td>\n      <td>1.68</td>\n      <td>0.694</td>\n      <td>UW</td>\n      <td>EH</td>\n      <td>MCW</td>\n      <td>--</td>\n      <td>48.679</td>\n      <td>-122.833</td>\n      <td>693.0</td>\n      <td>bucket7$0,:3,:15001</td>\n      <td>100.0</td>\n      <td>2002-10-03T01:55:59.530000Z</td>\n      <td>5894</td>\n      <td>5442</td>\n      <td>0.04</td>\n      <td>0.01</td>\n      <td>negative</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>nan|nan|27.185</td>\n      <td>eq</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2.1</td>\n      <td>0.03</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>0</td>\n      <td>7</td>\n      <td>0</td>\n      <td></td>\n      <td>ENZ</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>uw10568748</td>\n      <td>2002-09-26T07:00:04.860000Z</td>\n      <td>48.481</td>\n      <td>-123.133</td>\n      <td>earthquake</td>\n      <td>22.748</td>\n      <td>2.9</td>\n      <td>md</td>\n      <td>0.03</td>\n      <td>0.91</td>\n      <td>0.672</td>\n      <td>UW</td>\n      <td>HH</td>\n      <td>SP2</td>\n      <td>--</td>\n      <td>47.556</td>\n      <td>-122.249</td>\n      <td>30.0</td>\n      <td>bucket3$0,:3,:15001</td>\n      <td>100.0</td>\n      <td>2002-09-26T06:59:14.860000Z</td>\n      <td>8647</td>\n      <td>6948</td>\n      <td>0.04</td>\n      <td>0.01</td>\n      <td>negative</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>10.881|17.107|2.242</td>\n      <td>eq</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2.9</td>\n      <td>0.03</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>1</td>\n      <td>3</td>\n      <td>0</td>\n      <td></td>\n      <td>ENZ</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"   index    event_id           source_origin_time  source_latitude_deg  \\\n0      0  uw10564613  2002-10-03T01:56:49.530000Z               48.553   \n1      1  uw10564613  2002-10-03T01:56:49.530000Z               48.553   \n2      2  uw10564613  2002-10-03T01:56:49.530000Z               48.553   \n3      3  uw10564613  2002-10-03T01:56:49.530000Z               48.553   \n4      4  uw10568748  2002-09-26T07:00:04.860000Z               48.481   \n\n   source_longitude_deg source_type  source_depth_km  \\\n0              -122.520  earthquake           14.907   \n1              -122.520  earthquake           14.907   \n2              -122.520  earthquake           14.907   \n3              -122.520  earthquake           14.907   \n4              -123.133  earthquake           22.748   \n\n   preferred_source_magnitude preferred_source_magnitude_type  \\\n0                         2.1                              md   \n1                         2.1                              md   \n2                         2.1                              md   \n3                         2.1                              md   \n4                         2.9                              md   \n\n   preferred_source_magnitude_uncertainty  source_depth_uncertainty_km  \\\n0                                    0.03                         1.68   \n1                                    0.03                         1.68   \n2                                    0.03                         1.68   \n3                                    0.03                         1.68   \n4                                    0.03                         0.91   \n\n   source_horizontal_uncertainty_km station_network_code station_channel_code  \\\n0                             0.694                   UW                   BH   \n1                             0.694                   UW                   EH   \n2                             0.694                   UW                   BH   \n3                             0.694                   UW                   EH   \n4                             0.672                   UW                   HH   \n\n  station_code station_location_code  station_latitude_deg  \\\n0          GNW                    --                47.564   \n1          RPW                    --                48.448   \n2          SQM                    --                48.074   \n3          MCW                    --                48.679   \n4          SP2                    --                47.556   \n\n   station_longitude_deg  station_elevation_m           trace_name  \\\n0               -122.825                220.0  bucket4$0,:3,:15001   \n1               -121.515                850.0  bucket9$0,:3,:15001   \n2               -123.048                 45.0  bucket4$1,:3,:15001   \n3               -122.833                693.0  bucket7$0,:3,:15001   \n4               -122.249                 30.0  bucket3$0,:3,:15001   \n\n   trace_sampling_rate_hz             trace_start_time  \\\n0                   100.0  2002-10-03T01:55:59.530000Z   \n1                   100.0  2002-10-03T01:55:59.530000Z   \n2                   100.0  2002-10-03T01:55:59.530000Z   \n3                   100.0  2002-10-03T01:55:59.530000Z   \n4                   100.0  2002-09-26T06:59:14.860000Z   \n\n   trace_S_arrival_sample  trace_P_arrival_sample  \\\n0                    8097                    6733   \n1                    7258                    6238   \n2                    7037                    6113   \n3                    5894                    5442   \n4                    8647                    6948   \n\n   trace_S_arrival_uncertainty_s  trace_P_arrival_uncertainty_s  \\\n0                           0.04                           0.02   \n1                           0.04                           0.01   \n2                           0.08                           0.04   \n3                           0.04                           0.01   \n4                           0.04                           0.01   \n\n  trace_P_polarity trace_S_onset trace_P_onset         trace_snr_db  \\\n0      undecidable           NaN           NaN   6.135|3.065|11.766   \n1      undecidable           NaN           NaN       nan|nan|22.583   \n2      undecidable           NaN           NaN    1.756|3.057|3.551   \n3         negative           NaN           NaN       nan|nan|27.185   \n4         negative           NaN           NaN  10.881|17.107|2.242   \n\n  source_type_pnsn_label  source_local_magnitude  \\\n0                     eq                     NaN   \n1                     eq                     NaN   \n2                     eq                     NaN   \n3                     eq                     NaN   \n4                     eq                     NaN   \n\n   source_local_magnitude_uncertainty  source_duration_magnitude  \\\n0                                 NaN                        2.1   \n1                                 NaN                        2.1   \n2                                 NaN                        2.1   \n3                                 NaN                        2.1   \n4                                 NaN                        2.9   \n\n   source_duration_magnitude_uncertainty  source_hand_magnitude  \\\n0                                   0.03                    NaN   \n1                                   0.03                    NaN   \n2                                   0.03                    NaN   \n3                                   0.03                    NaN   \n4                                   0.03                    NaN   \n\n   trace_missing_channel  trace_has_offset  bucket  tindex trace_chunk  \\\n0                      0                 1       4       0               \n1                      2                 0       9       0               \n2                      0                 1       4       1               \n3                      2                 0       7       0               \n4                      0                 1       3       0               \n\n  trace_component_order  \n0                   ENZ  \n1                   ENZ  \n2                   ENZ  \n3                   ENZ  \n4                   ENZ  ","content_type":"text/plain"}}},"children":[],"key":"DnR08GlR8L"}],"key":"YwDm2pwyYM"}],"key":"UlW0eeNlCk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For each sample, we can get its waveform and metadata using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VZrhL3zK5y"},{"type":"inlineCode","value":"dataset.get_sample()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KgAv6PfyhR"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xhv6qxMF3X"}],"key":"so60I6SveF"}],"key":"W3LUKeF14O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"idx = 50\nwaveform_sp, metadata_sp = dataset.get_sample(idx) # returns waveforms and metadata for that sample\nprint(metadata_sp)\n\nplt.figure(figsize = (10, 5), dpi = 150)\nplt.plot(waveform_sp.T, c='gray')\nplt.xlabel(\"Samples\", fontsize = 12)\nplt.ylabel(\"Amplitude\", fontsize = 12)\nplt.grid(True, alpha=0.3)","key":"kDizcYDGpO"},{"type":"outputs","id":"50enFhDnv0zHhwCDuH6Nu","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"{'index': 50, 'event_id': 'uw10578728', 'source_origin_time': '2002-08-31T01:23:39.420000Z', 'source_latitude_deg': 47.419, 'source_longitude_deg': -120.078, 'source_type': 'earthquake', 'source_depth_km': 11.774, 'preferred_source_magnitude': 2.0, 'preferred_source_magnitude_type': 'md', 'preferred_source_magnitude_uncertainty': 0.04, 'source_depth_uncertainty_km': 1.08, 'source_horizontal_uncertainty_km': 0.68, 'station_network_code': 'UW', 'station_channel_code': 'EH', 'station_code': 'EPH', 'station_location_code': '--', 'station_latitude_deg': 47.356, 'station_longitude_deg': -119.597, 'station_elevation_m': 661.0, 'trace_name': 'bucket3$4,:3,:15001', 'trace_sampling_rate_hz': 100.0, 'trace_start_time': '2002-08-31T01:22:49.420000Z', 'trace_S_arrival_sample': 6119, 'trace_P_arrival_sample': 5642, 'trace_S_arrival_uncertainty_s': 0.06, 'trace_P_arrival_uncertainty_s': 0.04, 'trace_P_polarity': 'undecidable', 'trace_S_onset': nan, 'trace_P_onset': nan, 'trace_snr_db': 'nan|nan|21.872', 'source_type_pnsn_label': 'eq', 'source_local_magnitude': nan, 'source_local_magnitude_uncertainty': nan, 'source_duration_magnitude': 2.0, 'source_duration_magnitude_uncertainty': 0.04, 'source_hand_magnitude': nan, 'trace_missing_channel': 2, 'trace_has_offset': 1, 'bucket': 3, 'tindex': 4, 'trace_chunk': '', 'trace_component_order': 'ENZ', 'trace_source_sampling_rate_hz': array(100.), 'trace_npts': 15001}\n"},"children":[],"key":"YlpcWEOuig"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4a02bb68c24c5cae1be8d34216547390","path":"/4a02bb68c24c5cae1be8d34216547390.png"},"text/plain":{"content":"<Figure size 1500x750 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"BR0pWBVbMM"}],"key":"xa1lmS9OkM"}],"key":"MwIyTl6i6p"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BXXCLBViRg"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"3. SeisBench data augmentataion APIs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"d0BGZxJU7v"}],"identifier":"id-3-seisbench-data-augmentataion-apis","label":"3. SeisBench data augmentataion APIs","html_id":"id-3-seisbench-data-augmentataion-apis","implicit":true,"key":"FdBZmf6K7L"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"A generator is employed as a dataset wrapper, where users specify APIs for data pre-processing and augmentation. These are several augmentation methods implemented in the cell below.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"K08X2k5m2W"}],"key":"wAFtWjBCtM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.Filter","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SQzE7PP67Z"}],"key":"p5XCqVcahy"}],"key":"KbFlrPvpRq"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.WindowAroundSample","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fz1Ug35Y6X"}],"key":"wiV2d0aujZ"}],"key":"FqZgUPywIU"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.RandomWindow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JD05ERBZpC"}],"key":"bRHASXu9YZ"}],"key":"KLEEIVfJmS"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.Normalize","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hGvGDdXOuz"}],"key":"UuVbRgztjv"}],"key":"Ss5m0pbGkQ"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.DetectionLabeller","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"k6unsTJHQj"}],"key":"X3BkvWDu5Y"}],"key":"fiadCZVlOB"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"sbg.ProbabilisticLabeller","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kfLjTn4LWl"}],"key":"SwB58uYMJg"}],"key":"b4b5n002Mi"}],"key":"vnR4e4mHkP"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"üöÄ See ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nbxa9Yzpid"},{"type":"link","url":"https://seisbench.readthedocs.io/en/latest/pages/documentation/generate.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"https://‚Äãseisbench‚Äã.readthedocs‚Äã.io‚Äã/en‚Äã/latest‚Äã/pages‚Äã/documentation‚Äã/generate‚Äã.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Wy7nErnXoR"}],"urlSource":"https://seisbench.readthedocs.io/en/latest/pages/documentation/generate.html","key":"yBLPG8u8rF"},{"type":"text","value":" for all supported augmentation methods.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QVp6XKFyB3"}],"key":"f3SLhd3Ynk"}],"key":"g4GXrgRHiR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"generator = sbg.GenericGenerator(dataset)\n\nphase_dict = {\"trace_P_arrival_sample\": \"P\",\n              \"trace_S_arrival_sample\": \"S\"}\n\naugmentations = [\n    sbg.Filter(4, 0.1, \"highpass\", forward_backward=True),\n    sbg.WindowAroundSample(list(phase_dict.keys()), \n                           samples_before=5000, \n                           windowlen=10000, \n                           selection=\"first\", \n                           strategy=\"pad\"),\n    sbg.RandomWindow(windowlen=6000),\n    sbg.Normalize(demean_axis=-1, \n                  amp_norm_axis=-1, \n                  amp_norm_type=\"peak\"),\n    sbg.ChangeDtype(np.float32),\n    sbg.DetectionLabeller(\"trace_P_arrival_sample\", \n                          \"trace_S_arrival_sample\", \n                          factor=1.,\n                          dim=0, \n                          key=('X', 'y2')),\n    sbg.ProbabilisticLabeller(label_columns=phase_dict, \n                              shape='triangle', \n                              sigma=10, \n                              dim=0, \n                              key=('X', 'y1'))\n]\ngenerator.add_augmentations(augmentations)\nprint(generator)","key":"ryMB3WTigU"},{"type":"outputs","id":"T5qzFchZXEhw8PN2fNrnM","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'seisbench.generate.generator.GenericGenerator'> with 7 augmentations:\n 1.\tFilter (highpass, order=4, frequencies=0.1, analog=False, forward_backward=True, axis=-1)\n 2.\tWindowAroundSample (metadata_keys=['trace_P_arrival_sample', 'trace_S_arrival_sample'], samples_before=5000, selection=first)\n 3.\tRandomWindow (low=None, high=None)\n 4.\tNormalize (Demean (axis=-1), Amplitude normalization (type=peak, axis=-1))\n 5.\tChangeDtype (dtype=<class 'numpy.float32'>, key=('X', 'X'))\n 6.\tDetectionLabeller (label_type=multi_class, dim=0)\n 7.\tProbabilisticLabeller (label_type=multi_class, dim=0)\n\n"},"children":[],"key":"kv4XYKPfGP"}],"key":"ObwtrHdllX"}],"key":"YMfjP7JQLE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A generator is indexable.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XoC3abbMi2"}],"key":"m11hMzkefv"},{"type":"text","value":" You can use an index to access a specific data sample, and plot the waveforms.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vwxaCCA8OP"}],"key":"aUoLj0uPoq"}],"key":"uW6qc8fr12"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"idx = 0\nsp = generator[idx]\nfor k, v in sp.items():\n    print(\"-\"*100)\n    print({k: v})\n    print({k: v.shape})","key":"TmapiHvvKv"},{"type":"outputs","id":"klkED43yN66dzDz40lRfU","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"----------------------------------------------------------------------------------------------------\n{'X': array([[ 0.5028205 ,  0.49826217,  0.49422786, ..., -0.47398168,\n        -0.3446783 , -0.22915077],\n       [-0.08106346, -0.08391804, -0.08632651, ..., -0.14722095,\n        -0.16184352, -0.15441144],\n       [-0.18536477, -0.18804231, -0.1924158 , ..., -0.26885262,\n        -0.2373294 , -0.20979185]], dtype=float32)}\n{'X': (3, 6000)}\n----------------------------------------------------------------------------------------------------\n{'y2': array([[0., 0., 0., ..., 1., 1., 1.]])}\n{'y2': (1, 6000)}\n----------------------------------------------------------------------------------------------------\n{'y1': array([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [1., 1., 1., ..., 1., 1., 1.]])}\n{'y1': (3, 6000)}\n"},"children":[],"key":"BPuurnRrma"}],"key":"py8r7AYjCF"}],"key":"PmJCKtFgwl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize = (10, 5), dpi = 150)\nplt.plot(sp['X'][0, :].T, c='gray')\nplt.xlabel(\"Samples\", fontsize = 12)\nplt.ylabel(\"Data amplitude\", fontsize = 12)\nplt.grid(True, alpha=0.3)\n\nax = plt.gca().twinx()\nax.plot(sp['y1'][0, :].T, label = \"P Pick\", c=\"#c00000\")\nax.plot(sp['y1'][1, :].T, label = \"S Pick\", c=\"#2f6eba\")\nax.plot(sp['y2'][0, :].T, label = \"Detection\", color='k', zorder=-1)\nplt.ylabel(\"Label amplitude\", fontsize = 12)\n\nplt.legend(loc = 'upper left')","key":"eh17WpU8dH"},{"type":"outputs","id":"6CmSeszuj3h4obAWP6VPV","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"baae95f9fef1a479d9696e59bd24f1fc","path":"/baae95f9fef1a479d9696e59bd24f1fc.png"},"text/plain":{"content":"<Figure size 1500x750 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"MUqNAgZACt"}],"key":"UTYRlGRo1S"}],"key":"ooPQIq0pH1"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MlG621y7Po"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"4. Loading data in batch","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JnfiojvsbC"}],"identifier":"id-4-loading-data-in-batch","label":"4. Loading data in batch","html_id":"id-4-loading-data-in-batch","implicit":true,"key":"G24izt4VJe"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Machine Learning model training usually load data in batch. The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GPlfC0H5Fy"},{"type":"inlineCode","value":"generator","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vMzTXosyvL"},{"type":"text","value":" object can be wrapped by the pytorch API ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jM1U3nSuNY"},{"type":"inlineCode","value":"torch.utils.data.DataLoader","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"foFVxd402E"},{"type":"text","value":" to generate samples in batch. See examples below that creates a data loader and return 256 samples in batch.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RXfpNhLTTy"}],"key":"IpEybWh6AR"}],"key":"G41emoefSW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"batch_size = 256\nloader = torch.utils.data.DataLoader(generator, \n                    batch_size=batch_size, shuffle=True, num_workers=0)","key":"ac83ICsjr4"},{"type":"outputs","id":"kGTajNJGDJFaNSux5RCsr","children":[],"key":"eyuGYvuqpW"}],"key":"uESAn2r3Uy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"See the changes in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jHPoRUI9Uw"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"array size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7tqsxpK5V"}],"key":"y5ag7mjwAh"},{"type":"text","value":" as well as the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q0kVtUftTy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"array type","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T1gaQqaFMm"}],"key":"U7UxJmGRCl"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lDPnEv8PLe"}],"key":"S8dT8dxe4y"}],"key":"KQ0S7dAPjJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for i in loader:\n    for k, v in i.items():\n        print(\"-\"*100)\n        print({k: v})\n        print({k: v.shape})\n    break","key":"vS6sK3aDAV"},{"type":"outputs","id":"VN5mKupwl6sdmxsR-Lc52","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"----------------------------------------------------------------------------------------------------\n{'X': tensor([[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 7.6454e-03,  1.0564e-02,  1.7516e-02,  ...,  6.3099e-03,\n          -1.5590e-02, -1.7952e-02]],\n\n        [[ 5.1433e-01,  5.1804e-01,  5.2179e-01,  ...,  3.4767e-04,\n           1.9591e-04,  1.6224e-04],\n         [ 5.4271e-02,  5.1613e-02,  5.2406e-02,  ...,  6.3317e-02,\n           6.0317e-02,  6.2162e-02],\n         [ 8.0240e-02,  7.6082e-02,  7.3566e-02,  ..., -4.6032e-02,\n          -4.0793e-02, -4.0408e-02]],\n\n        [[-3.9497e-01, -3.8880e-01, -3.8297e-01,  ...,  6.2524e-02,\n           5.7797e-02,  5.5235e-02],\n         [-7.8458e-03, -6.4780e-03, -5.2017e-03,  ..., -2.6047e-01,\n          -2.5525e-01, -2.4984e-01],\n         [ 2.1773e-01,  2.1298e-01,  2.0873e-01,  ..., -2.3250e-02,\n          -2.1913e-02, -1.7747e-02]],\n\n        ...,\n\n        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [-1.6720e-02, -5.8528e-03,  8.1196e-03,  ...,  1.0182e-02,\n          -2.5844e-03, -1.8457e-02]],\n\n        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 8.1314e-03,  5.9321e-03, -2.8691e-03,  ..., -4.1186e-03,\n           2.1731e-02,  2.7229e-02]],\n\n        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 1.4159e-02,  2.1338e-02,  2.6946e-02,  ..., -7.1108e-03,\n          -5.2330e-03, -7.6930e-03]]])}\n{'X': torch.Size([256, 3, 6000])}\n----------------------------------------------------------------------------------------------------\n{'y2': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.]],\n\n        ...,\n\n        [[0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.]]], dtype=torch.float64)}\n{'y2': torch.Size([256, 1, 6000])}\n----------------------------------------------------------------------------------------------------\n{'y1': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]],\n\n        ...,\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [1., 1., 1.,  ..., 1., 1., 1.]]], dtype=torch.float64)}\n{'y1': torch.Size([256, 3, 6000])}\n"},"children":[],"key":"wIajZK9Tjy"}],"key":"mMkmefKcs5"}],"key":"LOlh5EEOD1"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rTXHg61Jsj"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Er77PPhoTz"}],"identifier":"reference","label":"Reference","html_id":"reference","implicit":true,"key":"SJ1Qo3VcI1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/niyiyu/PNW-ML","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"https://‚Äãgithub‚Äã.com‚Äã/niyiyu‚Äã/PNW‚Äã-ML","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uV6INh6Fkz"}],"urlSource":"https://github.com/niyiyu/PNW-ML","error":true,"key":"UN9x08KbvX"}],"key":"MVNeK6cuYv"}],"key":"mUtscJCgTo"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni, Y., Hutko, A., Skene, F., Denolle, M., Malone, S., Bodin, P., Hartog, R., & Wright, A. (2023). Curated Pacific Northwest AI-ready Seismic Dataset. Seismica, 2(1).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E7dG8nvP8B"}],"key":"ukdjwsiH7U"}],"key":"nwLn1uIPte"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/seisbench/seisbench","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://‚Äãgithub‚Äã.com‚Äã/seisbench‚Äã/seisbench","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vZGiHspy1X"}],"urlSource":"https://github.com/seisbench/seisbench","error":true,"key":"YEM6GCgD2d"}],"key":"BReFuSr1ac"}],"key":"GjdUerKWCE"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Woollam, J., M√ºnchmeyer, J., Tilmann, F., Rietbrock, A., Lange, D., Bornstein, T., ... & Soto, H. (2022). SeisBench‚ÄîA toolbox for machine learning in seismology. Seismological Society of America, 93(3), 1695-1709.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aehzgUtg33"}],"key":"Z3iCHHu5OL"}],"key":"xteCu34tvp"}],"key":"WRpDXrIkgx"}],"key":"BsSYkulKar"}],"key":"Hx09uUD22X"},"references":{"cite":{"order":[],"data":{}}}}