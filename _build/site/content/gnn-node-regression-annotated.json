{"version":3,"kind":"Notebook","sha256":"1286861481a3a0d192905f72f933063feb498d92fa12e1c82a687aedb3a5ab98","slug":"gnn-node-regression-annotated","location":"/notebooks/Loic/GNN/GNN_node_regression_annotated.ipynb","dependencies":[],"frontmatter":{"title":"üåê GNN for Node-Level Regression: Predicting Sine Waves","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Amanda M. Thomas, William Marfo, and Lo√Øc Bachelot","name":"Amanda M. Thomas, William Marfo, and Lo√Øc Bachelot"}],"keywords":["earthquake","catalog","ML","AI"],"numbering":{"title":{"offset":3}},"exports":[{"format":"ipynb","filename":"GNN_node_regression_annotated.ipynb","url":"/GNN_node_regression_-79b6a962209563d574d083417debf398.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TTPKhKpMs7"}],"key":"qpVFS6wrnJ"},{"type":"text","value":" Lo√Øc Bachelot","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AlkSJZp9us"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PtVRi2lZrL"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Goal:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HWNeFA7YJU"}],"key":"VTNjy2Bnkz"},{"type":"text","value":" This notebook demonstrates how to use a GNN to predict 1D sine wave signals at each node of a synthetic graph.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sU5b3MA4lj"}],"key":"nJOh4QeMHe"},{"type":"thematicBreak","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ccCYlikjFu"},{"type":"heading","depth":2,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"üìò Overview","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zjImWQ9VOw"}],"identifier":"id-overview","label":"üìò Overview","html_id":"id-overview","implicit":true,"key":"XnfUdES71c"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Graphs provide a natural framework to represent structured spatial relationships, like seismic stations or sensor networks.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZaqXb495Cw"}],"key":"chQZ1Ieokm"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"In this notebook:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uplFdbhOHZ"}],"key":"qHEgM9HtdU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Each node in the graph has spatial coordinates and a local signal (a sine wave).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lQEgyL4kKR"}],"key":"sCA3wbWvrf"}],"key":"Jvi1RY3OoL"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The task is to predict the full sine wave ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JMapV1SlHn"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"at each node","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"AdBlEhxc6n"}],"key":"ytYxufl5R7"},{"type":"text","value":" based on the graph structure and node features.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fnSunmHvkA"}],"key":"o1wmyl3aOP"}],"key":"MyH5M6MpWk"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We use ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"vgXMdaMJ5P"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"GNNs","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gkG8BYG7CR"}],"key":"kW8Eam7SQY"},{"type":"text","value":" with message passing to exploit the spatial relationships between nodes.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fNPOxtEAcn"}],"key":"v3g4dxqV5W"}],"key":"FMPUr2AFsn"}],"key":"NMJbz1walj"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"We will:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"PFEFzSOtqc"}],"key":"vIUtBjzjtw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generate synthetic 3D graphs with signals delayed based on spatial distance","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"NmZqg40Jcf"}],"key":"uZTfrVaPXp"}],"key":"DNcOFTM7Z4"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define a GNN model for ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ufU3Js9Vcm"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"node-level regression","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BU5ZniKbqk"}],"key":"e6pJ704dHj"}],"key":"P0NyJwk9OF"}],"key":"KLnpXBIx0Q"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Train the model to recover sine signals from noisy observations","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"zbOLhSaG0r"}],"key":"hQbqqjeA4A"}],"key":"bpvnju04hl"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize and evaluate the predictions at the node level","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"XGxRzwEkVX"}],"key":"Ki3kjdakMq"}],"key":"TTgRgCCjdi"}],"key":"zz0AqexHsd"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"This setup introduces important concepts for modeling spatiotemporal data with graph-based deep learning!","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"eB8WL6jrxv"}],"key":"mXwVvdn0W9"}],"key":"vOnLXvMgn0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üì¶ Imports and Setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b13NRLLFNf"}],"identifier":"id-imports-and-setup","label":"üì¶ Imports and Setup","html_id":"id-imports-and-setup","implicit":true,"key":"hTG43iN84f"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We first import the core libraries needed for:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g9ypRGJzto"}],"key":"SYahgf9gbZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Graph data manipulation (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"arRMz2rcMT"},{"type":"inlineCode","value":"torch_geometric","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mOnjIkYpsj"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"alTTOttBdM"}],"key":"yQoR6lYtda"}],"key":"UwtYspRfGk"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Deep learning (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"w72BNNuUUw"},{"type":"inlineCode","value":"torch","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Wbe1uTjzIC"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hVqYluMXxB"}],"key":"jxtTfmCr5J"}],"key":"YX1Kbk83sB"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Numerical operations (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tfdZmMqnDD"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z2PbKdJI1W"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Rb42FOMIPE"}],"key":"GvY8vMS9Tx"}],"key":"E6gqLIKZ8c"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualization (","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RAYevyW4he"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bEDUZqc5Cj"},{"type":"text","value":")","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EYx5deOKud"}],"key":"ePMeQCqR2j"}],"key":"gfUhkp9Sy6"}],"key":"iTuOzGnfI1"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This setup ensures we have all the tools needed for dataset generation, model training, and evaluation.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AEZ1vxVzP0"}],"key":"VhNk5qoqIq"}],"key":"tdsomsaj5b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch_geometric\nprint(torch.__version__)\nprint(torch_geometric.__version__)","key":"smDz2Vncb3"},{"type":"outputs","id":"zw1uYRgdPCUKXqFCcHY3o","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"2.6.0+cu124\n2.6.1\n"},"children":[],"key":"bEdOC4Vynx"}],"key":"UBZpr9Wdan"}],"key":"EWVE0hnd9r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%pip install pyg_lib torch_scatter torch_sparse torch_cluster torch_spline_conv -f https://data.pyg.org/whl/torch-2.6.0+cu124.html","key":"RdCg2u9GgD"},{"type":"outputs","id":"Xst8kYkuH6snY-1ZKXckw","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Looking in links: https://data.pyg.org/whl/torch-2.6.0+cu124.html\nRequirement already satisfied: pyg_lib in /srv/conda/envs/notebook/lib/python3.12/site-packages (0.4.0+pt26cu124)\nRequirement already satisfied: torch_scatter in /srv/conda/envs/notebook/lib/python3.12/site-packages (2.1.2+pt26cu124)\nRequirement already satisfied: torch_sparse in /srv/conda/envs/notebook/lib/python3.12/site-packages (0.6.18+pt26cu124)\nRequirement already satisfied: torch_cluster in /srv/conda/envs/notebook/lib/python3.12/site-packages (1.6.3+pt26cu124)\nRequirement already satisfied: torch_spline_conv in /srv/conda/envs/notebook/lib/python3.12/site-packages (1.2.2+pt26cu124)\nRequirement already satisfied: scipy in /srv/conda/envs/notebook/lib/python3.12/site-packages (from torch_sparse) (1.15.1)\nRequirement already satisfied: numpy<2.5,>=1.23.5 in /srv/conda/envs/notebook/lib/python3.12/site-packages (from scipy->torch_sparse) (1.26.4)\nNote: you may need to restart the kernel to use updated packages.\n"},"children":[],"key":"cz54XHWQUx"}],"key":"OyGnwpf14n"}],"key":"yxZNTGnp3f"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import pickle\nimport shutil\nimport os\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom torch_geometric.data import Data\nimport torch\nimport torch_geometric\nfrom torch_geometric.transforms import KNNGraph\nfrom torch_geometric.data import InMemoryDataset, Data\nfrom torch.nn import Linear, Parameter, LeakyReLU, Conv2d, MaxPool1d, Conv1d\nfrom torch_geometric.nn import GCNConv, MessagePassing, MLP, GATv2Conv  \nfrom scipy.spatial import distance\nfrom torch_geometric.utils import add_self_loops, degree\nfrom tqdm import tqdm\nimport time\nimport random\nimport os","visibility":"show","key":"BKz58YxUNi"},{"type":"outputs","id":"PaAGXe1MZ65E9MQkPcGyr","children":[],"visibility":"show","key":"KbkwYoakt8"}],"visibility":"show","key":"cdoT6XdvvJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üñºÔ∏è Visualization Helper Functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A4ntZmEBXF"}],"identifier":"id-visualization-helper-functions","label":"üñºÔ∏è Visualization Helper Functions","html_id":"id-visualization-helper-functions","implicit":true,"key":"cmecD7zuIP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We define two visualization utilities to better explore and understand the synthetic graphs.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gu7WJYjwhO"}],"key":"PUaZ7tCJu6"},{"type":"thematicBreak","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lJuCSnMJRh"},{"type":"heading","depth":3,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"üåê 1. ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XVbF2bHBKn"},{"type":"inlineCode","value":"visualize_graph_torch()","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"luOeD2e9tX"}],"identifier":"id-1-visualize-graph-torch","label":"üåê 1. visualize_graph_torch()","html_id":"id-1-visualize-graph-torch","implicit":true,"key":"L4xaFajg9w"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Plots the graph structure with flexible coloring options.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Cq0XBpkgtG"}],"key":"fVXe5lb1Fd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Edges","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dHQW4rMgrF"}],"key":"SReejrmUl3"},{"type":"text","value":" are plotted as light gray lines connecting nodes.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pFXud4GKKl"}],"key":"hsdsfoJHf3"}],"key":"cUBKkezHx1"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Nodes","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tQn0UwzTGN"}],"key":"iNTfAYB3Bw"},{"type":"text","value":" are colored based on:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PFgn3R2xSX"}],"key":"mLi4sSK704"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"An internal attribute (e.g., ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"sEIEVOLrvQ"},{"type":"inlineCode","value":"\"signal\"","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uvGOks7S7w"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tsewrWjyCO"},{"type":"inlineCode","value":"\"attention\"","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hXCOew68NF"},{"type":"text","value":")","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lyiMmmWWLb"}],"key":"YKhi7fYap4"}],"key":"gOKZYcQu50"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Or external per-node values (e.g., prediction errors).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"W52sDVXPjU"}],"key":"Am9elJuamE"}],"key":"xWKdt6C3zn"}],"key":"UoMnCvlwKX"}],"key":"rtJ3D0DlLV"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Origin","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XYWcQQzINf"}],"key":"qN2Itino5B"},{"type":"text","value":" (hidden point that controls the delay) is plotted as a ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"DfV0CdPu1Z"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"red cross (√ó)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XAD3NWNAMe"}],"key":"jZPRCuf8F6"},{"type":"text","value":" if available.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"f2vDyw2gqp"}],"key":"c1PYxzM0HX"}],"key":"n3WIaJ9s1v"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A colorbar is automatically generated to aid interpretation.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Hxilso5kus"}],"key":"a9gEH1Mzqv"}],"key":"ylXuUhG1Gq"}],"key":"qdQsJy8Ucg"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"‚úÖ Useful for visualizing spatial structure, feature distributions, and model errors.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Or8ZzpbdYm"}],"key":"UroXHS4Xnm"},{"type":"thematicBreak","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"MHLenhJwnw"},{"type":"heading","depth":3,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"üìà 2. ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Bj2Nc6BuAo"},{"type":"inlineCode","value":"plot_signals_subplots_by_distance()","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"SKC9XSOxbn"}],"identifier":"id-2-plot-signals-subplots-by-distance","label":"üìà 2. plot_signals_subplots_by_distance()","html_id":"id-2-plot-signals-subplots-by-distance","implicit":true,"key":"fQGx7qpGuD"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Visualizes the individual node signals sorted by distance from the hidden origin.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"bHAz0Hutp6"}],"key":"co6end837l"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"One subplot per node","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kZhKHtajEf"}],"key":"DrbjVxQuNX"},{"type":"text","value":": each shows the sine waveform observed at that node.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"EjfjqJ1K00"}],"key":"Z97rm5mbWF"}],"key":"J34ta2nEXf"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Nodes are ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Sql2fHbiYd"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"sorted","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"V9KpYzYdmu"}],"key":"yxFXJ0DHIX"},{"type":"text","value":" by increasing distance to the origin.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"DJ75eMnYQJ"}],"key":"YgQC5Q9xCj"}],"key":"y9de6cnyAh"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"WEkgNxdKcb"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"vertical red dashed line","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"QpBsDbeVQ5"}],"key":"qAIvWyEj2f"},{"type":"text","value":" marks the expected arrival time of the sine wave based on distance and velocity.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"qvNfi27j8H"}],"key":"IZZPb8eXOo"}],"key":"LC079mmWzC"}],"key":"ZPPaoa72VY"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"‚úÖ Useful for understanding how distance delays the waveform across the graph.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"fkFHl6Zz7c"}],"key":"JDJG77djJM"},{"type":"thematicBreak","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"A4edrGcwnb"}],"key":"vlLZ64FP58"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def visualize_graph_torch(g, color=None, node_values=None, cmap=\"viridis\", ax=None, title=None):\n    \"\"\"\n    Visualize a graph structure with nodes colored by a selected attribute or external values.\n\n    Args:\n        g (Data): PyG graph object with at least 'edge_index' and 'pos'. May also have 'origin'.\n        color (str, optional): Node attribute key inside `g` to color nodes (e.g., 'signal').\n        node_values (Tensor, optional): External array of node values for coloring (overrides `color` if provided).\n        cmap (str, optional): Matplotlib colormap name for node coloring.\n        ax (matplotlib axis, optional): Axis to plot into (if None, create a new figure).\n        title (str, optional): Title for the plot.\n\n    Behavior:\n        - Nodes are colored based on either an internal attribute or external values.\n        - Edges are drawn as light gray lines between connected nodes.\n        - A colorbar is added automatically when node coloring is used.\n        - If `origin` is present, it is shown as a red \"x\" marker.\n    \"\"\"\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(6, 6))\n\n    # --- Draw edges ---\n    for edge in g.edge_index.T:\n        ax.plot(\n            [g.pos[edge[0]][0], g.pos[edge[1]][0]],\n            [g.pos[edge[0]][1], g.pos[edge[1]][1]],\n            color='lightgray', linewidth=0.8, zorder=0\n        )\n\n    # --- Determine node coloring ---\n    if node_values is not None:\n        node_colors = node_values\n    elif color is not None:\n        node_colors = g[color][:, 0].cpu().numpy()\n    else:\n        node_colors = \"blue\"  # fallback color\n\n    # --- Draw nodes ---\n    scatter = ax.scatter(\n        g.pos[:, 0].cpu(),\n        g.pos[:, 1].cpu(),\n        c=node_colors,\n        cmap=cmap,\n        s=150,\n        edgecolors='black'\n    )\n\n    # --- Plot origin if available ---\n    if hasattr(g, 'origin'):\n        origin = g.origin.cpu().numpy()\n        ax.plot(origin[0], origin[1], 'rx', markersize=12, markeredgewidth=3, label=\"Origin\")\n        ax.legend(loc=\"upper right\")\n\n    # --- Add colorbar if appropriate ---\n    if node_values is not None or color is not None:\n        plt.colorbar(scatter, ax=ax, label=\"Node Value\")\n\n    if title:\n        ax.set_title(title)\n\n    ax.set_xlabel(\"x\")\n    ax.set_ylabel(\"y\")\n    ax.grid(True, linestyle=\"--\", alpha=0.5)\n\n    if ax is None:\n        plt.show()\n\n\n\ndef plot_signals_subplots_by_distance(data, velocity=0.25, sampling_rate=1.0, title=\"Signals by distance to origin\"):\n    \"\"\"\n    Plot each node's signal in its own subplot, ordered by distance to the hidden origin.\n\n    Args:\n        data (Data): PyG graph object containing:\n            - pos: [num_nodes, 2] node spatial coordinates\n            - signal: [num_nodes, signal_size] node waveforms\n            - origin: [2] hidden origin point (required to compute distance)\n        velocity (float): Wave propagation speed (units per second).\n        sampling_rate (float): Sampling rate in Hz (samples per second).\n        title (str): Figure title.\n\n    Behavior:\n        - Sorts nodes by their distance to the origin.\n        - Plots each node's signal in a separate subplot.\n        - Marks the expected arrival sample with a red vertical line.\n    \"\"\"\n    pos = data.pos.cpu().numpy()\n    signals = data.signal.cpu().numpy()\n    origin = data.origin.squeeze().cpu().numpy()\n\n    num_nodes = pos.shape[0]\n\n    # Compute distances from origin and convert to sample index\n    distances = np.array([distance.euclidean(origin, pos[i].tolist()) for i in range(num_nodes)])\n    arrival_samples = (distances / velocity * sampling_rate).astype(int)\n    sort_idx = np.argsort(distances)\n\n    # Plot one subplot per station\n    fig, axs = plt.subplots(num_nodes, 1, figsize=(10, 2 * num_nodes), sharex=True)\n    for i, idx in enumerate(sort_idx):\n        ax = axs[i]\n        signal = signals[idx]\n\n        ax.plot(np.arange(len(signal)), signal, color='black', linewidth=1)\n        ax.axvline(arrival_samples[idx], color='red', linestyle='--', linewidth=1, label='arrival')\n        ax.set_ylabel(f\"{distances[idx]:.2f}\", rotation=0, labelpad=25)\n        ax.grid(True, linestyle='--', alpha=0.3)\n\n    axs[-1].set_xlabel(\"Time (samples)\")\n    fig.suptitle(title, fontsize=14)\n    plt.tight_layout(rect=[0, 0, 1, 0.98])\n    plt.show()","visibility":"show","key":"TpuwSJCciA"},{"type":"outputs","id":"O5ZewcTT1i5g3HCL_zt2o","children":[],"visibility":"show","key":"xiGwvjU2Z1"}],"visibility":"show","key":"HIM1fkNL72"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üßπ Synthetic Dataset Creation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z4HnhGTysg"}],"identifier":"id-synthetic-dataset-creation","label":"üßπ Synthetic Dataset Creation","html_id":"id-synthetic-dataset-creation","implicit":true,"key":"XdjeUY3SvF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We create a synthetic graph dataset where each node has:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N1zW6RMtha"}],"key":"rJ9LxtVNX0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Random 2D spatial coordinates","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bgkMPTTNHw"}],"key":"ut7a1V5M0J"}],"key":"P4vXlj645y"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rwWCiMfbnm"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"sine wave","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uAvW5vSrtt"}],"key":"Du7uMnPU5E"},{"type":"text","value":" signal, delayed according to its distance from a hidden origin point","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U1sKZqqOzn"}],"key":"cKWdkMYByt"}],"key":"eqonlxCeIN"}],"key":"NTiOo0Sbgn"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The task is to predict the correct sine signal at each node, using the spatial structure and nearby signals as context.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MiihTvI2FS"}],"key":"ByqML02rXc"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"i0ZoIFq9Tl"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Components:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fA8JtQhyex"}],"identifier":"id-components","label":"üõ†Ô∏è Components:","html_id":"id-components","implicit":true,"key":"dXP1VJpSCe"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineCode","value":"add_edge_weight(g)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"sYNiG1LgVN"}],"key":"A0Ui4JwyJM"},{"type":"break","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BjX4FZDAPo"},{"type":"text","value":"A utility function that computes edge weights based on inverse spatial distance, helping GNN layers better prioritize closer nodes.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KlY751Pnpt"}],"key":"VAjQCDl3Jl"}],"key":"JtablRHoBb"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"inlineCode","value":"SinDataset","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"DNU6Mh7TCW"},{"type":"text","value":" Class","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"fc9X4pfOQN"}],"key":"wvV0sux5IX"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"SdXKgWqAnj"},{"type":"text","value":"A PyTorch Geometric ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"AqPXQuN8X7"},{"type":"inlineCode","value":"InMemoryDataset","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tdTDYFsXqm"},{"type":"text","value":" that:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"OFOq1SOz8L"}],"key":"WGXHWR4Aec"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generates random graphs","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"LaQ80ZbjpC"}],"key":"HDoYgIkGjq"}],"key":"yFx0YJso2f"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Assigns sine signals to nodes with distance-based delays","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Fvq7ruPHS9"}],"key":"DZxGprkFS7"}],"key":"Bbg9sh1Qmh"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Saves origin coordinate of signal","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Hh4VRNmXVT"}],"key":"CyneKUGrTO"}],"key":"abenmv6bzK"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optionally applies transformations like edge construction","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"TYbLib2IZ7"}],"key":"WMDZz2y50d"}],"key":"N89pMh8Zfj"}],"key":"pDI5d5KrJM"}],"key":"N3ygLPz03N"}],"key":"o12QDPxFVO"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"This synthetic setup allows us to benchmark node-level regression performance.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FF5aFAWzNl"}],"key":"sUPaeNfozG"}],"key":"irrMZ7oRBm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def add_edge_weight(g):\n    \"\"\"\n    Compute edge features as (dx, dy) vectors between connected nodes.\n    \"\"\"\n    edge_attrs = []\n\n    for edge in g.edge_index.T:\n        src = g.pos[edge[0]]\n        tgt = g.pos[edge[1]]\n        delta = tgt - src  # (dx, dy)\n        edge_attrs.append(delta)\n\n    # Stack into [num_edges, 2] tensor\n    g.edge_attr = torch.stack(edge_attrs, dim=0).type(torch.float32)\n    return g\n\n\nclass SinDataset(InMemoryDataset):\n    \"\"\"\n    Synthetic dataset for node-level sine wave reconstruction,\n    using a **fixed set of node positions (\"stations\")** across all graphs.\n\n    Each graph contains:\n    - Same station layout (pos)\n    - Different random hidden origin\n    - Signals delayed based on distance to origin\n    \"\"\"\n\n    def __init__(self, root, transform=None, pre_transform=None, nb_graph=10, nb_stations=15):\n        self.nb_graph = nb_graph\n        self.nb_stations = nb_stations\n        np.random.seed(42)\n        # Generate fixed station positions once\n        self.node_positions = torch.tensor(\n            np.random.uniform(0, 6, size=(self.nb_stations, 2)),\n            dtype=torch.float\n        )\n        super(SinDataset, self).__init__(root, transform, pre_transform)\n        self.data, self.slices = torch.load(self.processed_paths[0], weights_only=False)\n\n    @property\n    def raw_file_names(self):\n        # No external raw files\n        return 0\n\n    @property\n    def processed_file_names(self):\n        return 'data.pt'\n\n    def process(self):\n        data_list = []\n\n        # Dataset parameters\n        frequency = 1.0        # Hz\n        velocity = 0.25         # wave speed\n        sampling_rate = 1.0    # Hz\n        noise_std = 0.05        # Gaussian noise level\n\n        # Base sine wave used in signal synthesis\n        base_sine_wave = np.sin(np.arange(SIGNAL_SIZE))\n\n        for _ in range(self.nb_graph):\n            pos = self.node_positions\n\n            # Random hidden origin point\n            origin = np.random.randint(0, 6, size=2)\n            origin_tensor = torch.tensor(origin, dtype=torch.float)\n\n            signal_list = []\n            for i in range(self.nb_stations):\n                dist = distance.euclidean(origin, pos[i].tolist())\n                delay = dist / velocity\n                delay_samples = int(delay * sampling_rate)\n\n                # Start with noise\n                waveform = np.random.normal(0, noise_std, size=SIGNAL_SIZE)\n\n                # Add delayed sine wave if within bounds\n                if delay_samples < SIGNAL_SIZE:\n                    insert_length = SIGNAL_SIZE - delay_samples\n                    waveform[delay_samples:] += base_sine_wave[:insert_length]\n\n                signal_list.append(waveform)\n\n            signal = torch.tensor(np.array(signal_list), dtype=torch.float32).reshape(self.nb_stations, SIGNAL_SIZE)\n            g = Data(pos=pos, signal=signal, origin=origin_tensor)  # y shape: (1, 2)\n            data_list.append(g)\n            \n        # Apply preprocessing transformations if specified\n        if self.pre_transform is not None:\n            data_list = [self.pre_transform(data) for data in data_list]\n            data_list = [add_edge_weight(data) for data in data_list]\n\n        # Save processed graphs\n        data, slices = self.collate(data_list)\n        torch.save((data, slices), self.processed_paths[0])","visibility":"show","key":"NdZkMlIVCG"},{"type":"outputs","id":"K7VhfnN0P5ajLmFBFyQwZ","children":[],"visibility":"show","key":"PZab01t9vu"}],"visibility":"show","key":"zE5LGNmfzg"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\nSIGNAL_SIZE = 25\nNB_GRAPHS = 5000\nNB_STATION = 30\n\n# Dataset root path\ndataset_root = \"./sin_train_masked\"\n\n# üö® Remove old processed data if it exists\nprocessed_path = os.path.join(dataset_root, \"processed\")\nif os.path.exists(processed_path):\n    print(f\"Removing previously processed dataset at {processed_path}...\")\n    shutil.rmtree(processed_path)\n\n# Create fresh dataset\ndataset = SinDataset(\n    root=dataset_root,\n    pre_transform=KNNGraph(k=6, loop=False, force_undirected=True),\n    nb_graph=NB_GRAPHS, \n    nb_stations=NB_STATION\n)\n\ndataset","visibility":"show","key":"uEOKPBwUES"},{"type":"outputs","id":"TVLAlqe1fx14BBDO6Sky6","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Removing previously processed dataset at ./sin_train_masked/processed...\n"},"children":[],"key":"mKN4y139nr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"Processing...\nDone!\n"},"children":[],"key":"gzDWfNmbrr"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"SinDataset(5000)","content_type":"text/plain"}}},"children":[],"key":"G1Tg8lVP8D"}],"visibility":"show","key":"OqeWj8nSIF"}],"visibility":"show","key":"nU0qMFzoX4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üîç Exploring a Sample Graph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LE2TQ7h5tO"}],"identifier":"id-exploring-a-sample-graph","label":"üîç Exploring a Sample Graph","html_id":"id-exploring-a-sample-graph","implicit":true,"key":"wqJzoj5kxR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let‚Äôs inspect one sample from the synthetic dataset to understand its structure.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"np98RO5M1q"}],"key":"DAdTQPnc65"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Each graph is stored as a PyTorch Geometric ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"y0EYO96I5L"},{"type":"inlineCode","value":"Data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SYCgor8Vvq"},{"type":"text","value":" object, which includes:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CYKKmeJ4Es"}],"key":"wQvZgIGHPL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineCode","value":"pos","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WZ6QIf2dS2"}],"key":"nxybaGLPZC"},{"type":"text","value":": Node 2D spatial coordinates ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hJbaOmJYiT"},{"type":"inlineCode","value":"[num_nodes, 2]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tALUjwV9UQ"}],"key":"U0E5ztW6cU"}],"key":"nk8ropmCNV"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"signal","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DoTPUoB2dR"}],"key":"rwvBNma2ez"},{"type":"text","value":": Node signals (sine waves delayed by distance to a hidden origin) ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yWpJdsUzAc"},{"type":"inlineCode","value":"[num_nodes, signal_length]","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y6dU3RI5i5"}],"key":"YqGIJFfdR6"}],"key":"CKp4XA2bpK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"origin","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fSfc4MKkd0"}],"key":"e1L8x2gMIL"},{"type":"text","value":": The hidden 2D origin point ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lP6XwV9MR8"},{"type":"inlineCode","value":"[2]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PCxl2Osj7H"},{"type":"text","value":" used to generate node signals (not directly used for supervision here)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hLfvIVX6Cg"}],"key":"KHU087Zob5"}],"key":"ZNYPRaAxoF"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineCode","value":"edge_index","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"s4FiDqfuaQ"}],"key":"ssPojTg5E9"},{"type":"text","value":": Connectivity information between nodes (edges)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Xe2UUnbzsA"}],"key":"SJKAi0dv6c"}],"key":"osRiIPXqGd"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"edge_attr","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lycU4w1ILE"}],"key":"sPkOXAuANE"},{"type":"text","value":": distance weights for edges (both in x and y)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QatyFgZ6tK"}],"key":"qb9GZDVzru"}],"key":"pHZGfEo8mg"}],"key":"yO36lCmbPR"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This compact graph-based representation allows flexible training for node-level prediction tasks,","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EDOHNJqY6c"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QYFEM9WDsf"},{"type":"text","value":"while preserving spatial and relational structure essential for learning.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GhOy7my5Mv"}],"key":"Y5pRpSIwAj"}],"key":"csBCcG6oMN"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data = dataset[0]\ndata","visibility":"show","key":"SprwlgqjUI"},{"type":"outputs","id":"M1lHdRhBux06fv3MHqMrC","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"Data(pos=[30, 2], signal=[30, 25], origin=[2], edge_index=[2, 216], edge_attr=[216, 2])","content_type":"text/plain"}}},"children":[],"key":"pB4Pr0aDSs"}],"visibility":"show","key":"nLcP5BeBpp"}],"visibility":"show","key":"PYVYDaTOMh"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"visualize_graph_torch(data, color='signal')","visibility":"show","key":"CwpBXSzyD5"},{"type":"outputs","id":"yTc8hLKzUkaRnmRZtlqs_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3e3752e02016b12b8faeeaf9d705c6e6","path":"/3e3752e02016b12b8faeeaf9d705c6e6.png"},"text/plain":{"content":"<Figure size 600x600 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"utkMy8gZLk"}],"visibility":"show","key":"aVvYCe8H1J"}],"visibility":"show","key":"JDyODZyPHz"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_signals_subplots_by_distance(data)","visibility":"show","key":"rPmiUOjZKA"},{"type":"outputs","id":"oeKgAMoEgWQbMX40U2eX8","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e91c932513757203e16e775aa7af14c","path":"/9e91c932513757203e16e775aa7af14c.png"},"text/plain":{"content":"<Figure size 1000x6000 with 30 Axes>","content_type":"text/plain"}}},"children":[],"key":"sxxSksWoPo"}],"visibility":"show","key":"Y4Awo7aBGj"}],"visibility":"show","key":"kXl8MDdetb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üß™ Train/Validation/Test Split and Batching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NJ513do50y"}],"identifier":"id-train-validation-test-split-and-batching","label":"üß™ Train/Validation/Test Split and Batching","html_id":"id-train-validation-test-split-and-batching","implicit":true,"key":"fhGctmvD3T"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After generating the full synthetic dataset, we split it into three subsets:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QgDkP69Co2"}],"key":"nYfASiQ0ng"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"80%","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Exsj4dLWZL"}],"key":"rMc0asGMM4"},{"type":"text","value":" for training","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s5chpj9JCA"}],"key":"z72Sq7dojC"}],"key":"qZB1EySRr5"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"10%","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N06INXMreD"}],"key":"oNUniRoyNn"},{"type":"text","value":" for validation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Kmydaxllb3"}],"key":"xeykCrSnxL"}],"key":"SPyMPIggNK"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"10%","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nAzA9PvZXT"}],"key":"dgf7AYwQqi"},{"type":"text","value":" for testing","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pwqy1smYKj"}],"key":"GP435ivUvU"}],"key":"sB90kraGmv"}],"key":"SAnWaKrR4J"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We then use ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"V2Z92rULKW"},{"type":"inlineCode","value":"torch_geometric.loader.DataLoader","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oQiIe1vcp7"},{"type":"text","value":" to batch graphs during training and evaluation.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"p9oUdmX9nS"}],"key":"ohZfMJA3yq"},{"type":"heading","depth":4,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üß± How batching works in PyTorch Geometric:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xSqCWN2uAk"}],"identifier":"id-how-batching-works-in-pytorch-geometric","label":"üß± How batching works in PyTorch Geometric:","html_id":"id-how-batching-works-in-pytorch-geometric","implicit":true,"key":"RBc97kOaTC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Nodes, edges, and features from multiple graphs are merged into a single ‚Äúbig graph.‚Äù","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BbwW463G2n"}],"key":"XwnGp36Cq8"}],"key":"Vfop7rlDaw"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"r7ASduAcsC"},{"type":"inlineCode","value":"batch","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OETDRlo7Xn"},{"type":"text","value":" vector tracks which nodes belong to which original graph.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Nc9ejTHju7"}],"key":"OSQ8gORZ9j"}],"key":"Dm0i7wrIhC"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This enables efficient parallel processing across many small graphs in one forward pass.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vt1i67jPuC"}],"key":"EV9Kb0TgAN"}],"key":"i4jL1Fic8q"}],"key":"nxSk64RFgh"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"We set a ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Sg7lvo5nz0"},{"type":"inlineCode","value":"batch_size=64","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Tl0rvK6IQV"},{"type":"text","value":" and shuffle only the training set to ensure randomness while preserving validation/test consistency.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Jm3QWjuZQy"}],"key":"HtOXw3mfLU"}],"key":"miPPkWg21E"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from torch_geometric.loader import DataLoader\nfrom sklearn.model_selection import train_test_split\n\ntrain_dataset, val_dataset = train_test_split(dataset, train_size=0.8, random_state=42)\nval_dataset, test_dataset = train_test_split(val_dataset, train_size=0.5, random_state=42)\n\ntrain_loader = DataLoader(train_dataset, batch_size=64, shuffle=True)\nval_loader = DataLoader(val_dataset, batch_size=64, shuffle=False)\ntest_loader = DataLoader(test_dataset, batch_size=64, shuffle=False)\n\nprint(f\"nb graph train ds= {len(train_dataset)}, nb graph val ds= {len(val_dataset)}, nb graph test ds= {len(test_dataset)}\")","visibility":"show","key":"nRRCnkAMJD"},{"type":"outputs","id":"q5NsiULIAc-r91FaZzuGl","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"nb graph train ds= 4000, nb graph val ds= 500, nb graph test ds= 500\n"},"children":[],"key":"wtMYfypYgw"}],"visibility":"show","key":"R1UbDrFr45"}],"visibility":"show","key":"cW8cFQYPAl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üß† GNN Model Definition: BasicNet","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uDk2x1vIdl"}],"identifier":"id-gnn-model-definition-basicnet","label":"üß† GNN Model Definition: BasicNet","html_id":"id-gnn-model-definition-basicnet","implicit":true,"key":"Q6Dp95shq9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We define a Graph Neural Network (GNN) model designed for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SQxx4FKqjC"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"node-level sine wave regression","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y9HseyxPlc"}],"key":"M12nhiF3bs"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LgBh4OvFQX"}],"key":"yYx0obIZgY"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"üèóÔ∏è Architecture Overview:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"K1NIiCWFG0"}],"identifier":"id-architecture-overview","label":"üèóÔ∏è Architecture Overview:","html_id":"id-architecture-overview","implicit":true,"key":"a8h1mXw2oi"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Signal Feature Extraction","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bOWLP2NAS3"}],"key":"V1Y5ddx16q"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FxebPaGfQR"},{"type":"text","value":"Each node‚Äôs raw signal is processed through a simple MLP to extract compact local features.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AM5J6tVxPm"}],"key":"jq8ItgtKh5"}],"key":"nWuvmC4Rpc"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Feature Fusion","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rBPD0vOHcM"}],"key":"CRMQszeK6q"},{"type":"break","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eoqG7hxfjF"},{"type":"text","value":"The extracted signal features are concatenated with the node‚Äôs spatial coordinates (x, y) to create a combined feature vector.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AEcwsS2N2j"}],"key":"dQ9hHWuX97"}],"key":"jjqo17ukIU"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Graph Attention Message Passing","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"E20RUQWw6i"}],"key":"Pv85HjzySK"},{"type":"break","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bLHTiEQZee"},{"type":"text","value":"We apply a ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Wma5ZHrLsc"},{"type":"inlineCode","value":"GATv2Conv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZAGqo7TVRu"},{"type":"text","value":" layer to propagate and aggregate information between neighboring nodes:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zjqOrjoOLf"}],"key":"rrCOL3qdeG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Attention mechanisms allow the model to learn which neighbors are most informative.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"R4qYY5gWsT"}],"key":"RIFnAqguBx"}],"key":"nYrhxnnyz2"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Edge weights based on spatial distances are provided as additional input.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"R7i8sfkc01"}],"key":"E3G72e8fSA"}],"key":"h0k0uMGc3d"}],"key":"pbi0nGdUW1"}],"key":"uuDnhHee1i"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Multi-Layer Perceptron (MLP) Decoder","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SooHtmC3Lf"}],"key":"HJi09yiC2C"},{"type":"break","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"WXPnQPTP5m"},{"type":"text","value":"After message passing, another MLP refines the hidden features and predicts the full sine wave signal at each node.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"jbyLlcXmDK"}],"key":"Uqg68lOB4s"}],"key":"htbISC459D"}],"key":"kirQOVgOWo"},{"type":"blockquote","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"üî• ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"W5sjEGvexQ"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Key Difference","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"kQ9fuXf27L"}],"key":"f7IEG4eBtY"},{"type":"text","value":":","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ieg1ZbevTV"},{"type":"break","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"EIUKsN6eS3"},{"type":"text","value":"Instead of predicting a single global coordinate, this model predicts a ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"kh2s4lo7XM"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"full waveform per node","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"PjCg0tixU4"}],"key":"UJnxQQ6v56"},{"type":"text","value":".","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"fzhKlwAWu3"}],"key":"lSF2cvfQ1I"}],"key":"jX3Xo4ATSV"},{"type":"heading","depth":3,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"üì§ Output:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"P0oBHbTmAj"}],"identifier":"id-output","label":"üì§ Output:","html_id":"id-output","implicit":true,"key":"etGWtRqZ8m"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each node, the model outputs a predicted sine wave of the same length as the true target signal.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"iTZYEFxIMQ"}],"key":"kXbOmPF1WB"}],"key":"PEo646iW3R"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The output is bounded in the range ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"BwiWy4r3ze"},{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"[-1, 1]","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"GIEYouyv24"}],"key":"bGPI2mKTQ3"},{"type":"text","value":" using a ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"TUC0qbWrfh"},{"type":"inlineCode","value":"tanh()","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"dNOP5v4A01"},{"type":"text","value":" activation, consistent with sine wave values.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"NwXWzAG7E2"}],"key":"rxtF3XBcy2"}],"key":"N3QML6GRDo"}],"key":"rqMOen5hHp"}],"key":"dm6tgXOJDg"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"class BasicNet(torch.nn.Module):\n    \"\"\"\n    A minimal Graph Neural Network for node-level signal reconstruction.\n\n    Architecture:\n    - MLP to fuse spatial coordinates and raw signal\n    - Single GATv2Conv layer for graph message passing\n    - MLP decoder to reconstruct the node signals\n    \"\"\"\n    def __init__(self, channels_x, channels_y, hidden_channels=32, dropout=0.3):\n        super(BasicNet, self).__init__()\n        torch.manual_seed(1234)\n\n        # --- Feature fusion ---\n        self.mlp_in = MLP([channels_x + channels_y, hidden_channels])\n\n        # --- Graph convolution ---\n        self.conv = GATv2Conv(\n            in_channels=hidden_channels,\n            out_channels=hidden_channels,\n            heads=1,\n            concat=True,\n            edge_dim=2\n        )\n        self.conv2 = GATv2Conv(\n            hidden_channels, \n            hidden_channels, \n            heads=1, \n            concat=True, \n            edge_dim=2\n        )\n\n        # --- Decoder ---\n        self.mlp_out = MLP([hidden_channels, channels_y])\n\n    def forward(self, x, signal, edge_index, edge_attr, mask):\n        \"\"\"\n        Forward pass.\n\n        Args:\n            x (Tensor): Node features (e.g., spatial coordinates) [num_nodes, channels_x]\n            signal (Tensor): Node signals (raw) [num_nodes, channels_y]\n            edge_index (Tensor): Edge index for the graph\n            edge_weight (Tensor): Edge weights\n            mask (Tensor): Mask indicating supervised nodes\n\n        Returns:\n            Tensor: Reconstructed node signals [num_nodes, channels_y]\n        \"\"\"\n        # Apply mask (simulate missing inputs)\n        signal = (signal.T * (~mask)).T\n\n        # --- Feature fusion ---\n        out = torch.cat([x, signal], dim=-1)\n        out = self.mlp_in(out)\n\n        # --- Graph convolution ---\n        out = self.conv(out, edge_index, edge_attr)\n        out = self.conv2(out, edge_index, edge_attr)\n\n        # --- Final decoding ---\n        out = self.mlp_out(out)\n\n        return out.tanh()\n\n    @staticmethod\n    def get_mask(graph_size: int, rate: float, device):\n        \"\"\"\n        Randomly generate a node mask for supervision during training.\n    \n        Args:\n            graph_size (int): Number of nodes in the graph.\n            rate (float): Fraction of nodes to supervise (between 0 and 1).\n            device: Target device (CPU or GPU).\n    \n        Returns:\n            Tensor: A boolean mask indicating which nodes to supervise.\n        \"\"\"\n        mask = torch.rand(graph_size, device=device) < rate\n        return mask","visibility":"show","key":"YaGD4iHpjw"},{"type":"outputs","id":"HZET2fxQZv48WGy3gWP7Z","children":[],"visibility":"show","key":"iV5w5kz6H8"}],"visibility":"show","key":"qcLaLJwFyS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üöÄ Training Loop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hU9jJq1Baq"}],"identifier":"id-training-loop","label":"üöÄ Training Loop","html_id":"id-training-loop","implicit":true,"key":"HmAH0m7x56"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This section defines the training and validation routines for our GNN model, as well as a simple early stopping mechanism.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W0ldMdzf89"}],"key":"QXbKGOEGzn"}],"key":"kTJX2PpmLe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Training and Validation Helper Functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s79Q1D7FST"}],"identifier":"id-training-and-validation-helper-functions","label":"üõ†Ô∏è Training and Validation Helper Functions","html_id":"id-training-and-validation-helper-functions","implicit":true,"key":"OBgjLiiniy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before launching training, we define helper functions to structure the training and validation process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E3oqN41tZR"}],"key":"MlIOsg4WbO"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"‚èπÔ∏è Early Stopping: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jS2xI3twy8"},{"type":"inlineCode","value":"EarlyStopper","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gkVUgklB6B"}],"identifier":"id-early-stopping-earlystopper","label":"‚èπÔ∏è Early Stopping: EarlyStopper","html_id":"id-early-stopping-earlystopper","implicit":true,"key":"qVaTsUu9e9"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Early stopping monitors the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"C3WTxysry7"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"validation loss","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QfrXE56poS"}],"key":"P2svmIIaJ0"},{"type":"text","value":" to detect overfitting.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uB2LAwmJrn"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ab1Qi082R4"},{"type":"text","value":"It stops training when the model stops improving for a given number of epochs (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zzRcHAWfpD"},{"type":"inlineCode","value":"patience","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hQ33CKMZi4"},{"type":"text","value":").","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bjnemCUDS3"}],"key":"OMLic5GbVY"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This helps avoid:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TOCdTU3goA"}],"key":"irJOB58Gq0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wasting compute resources","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QYZIZMUf36"}],"key":"ueXrow5O20"}],"key":"QdFaSAGK8P"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Overfitting to the training set","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vfxDhgRd3o"}],"key":"ZmiuT4AeUG"}],"key":"D4735TJzY9"}],"key":"JQMXOW3A9H"},{"type":"thematicBreak","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KDUJbLkl7v"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Training Function: ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sZ0qv6KL0A"},{"type":"inlineCode","value":"train()","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jVdOPr7K7H"}],"identifier":"id-training-function-train","label":"üõ†Ô∏è Training Function: train()","html_id":"id-training-function-train","implicit":true,"key":"bvKASRfnOk"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"For each batch of graphs:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"U85VH3MwjO"}],"key":"QODTVsrNgq"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Dynamically generate a random mask","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"uXVUCKsSEQ"}],"key":"aJz8jlYYZA"},{"type":"text","value":" selecting a subset of nodes for supervision.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ONom2dycDQ"}],"key":"cslz78ZhAr"}],"key":"Z2VyOqmoyY"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform a forward pass through the model ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IwSgadE9Z1"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"using the generated mask","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Uw86ztjrYG"}],"key":"s3LiWfUYHD"},{"type":"text","value":" (the mask modifies the input signals).","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"m6LGiJTogd"}],"key":"wj2jHr5cE9"}],"key":"eEaTnPAL2h"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute the loss ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"DvOdkdmF4C"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"only on the masked (supervised) nodes","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"chZpergQk2"}],"key":"gyOLeMyVRI"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"L4mtfeEM2Q"}],"key":"AKJRetzBaQ"}],"key":"Om21SkV7i0"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Backpropagate and update model parameters.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"MkjQz8fqfg"}],"key":"ku0k4I6Pwt"}],"key":"rmC6ZYPWoh"}],"key":"zw0c8R12ZL"},{"type":"blockquote","position":{"start":{"line":23,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fALwY3Ucmj"},{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Why use a dynamic mask?","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"DCbxHBDr03"}],"key":"GiZ9yRVYiT"}],"key":"ODVMJaglOO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In node-level prediction, we don‚Äôt want to supervise all nodes.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"kNTza3AyIH"}],"key":"fg7P6Ngk4l"}],"key":"pHYKIqogf0"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In this use case, the target is the input itself, so without masking, a node could trivially copy its input!","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"OSTDelucwv"}],"key":"ZE9iuwawJC"}],"key":"byJTEVhMDK"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Dynamic masking ensures the model must infer missing signals by leveraging neighborhood information.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"QqGNzKnBoD"}],"key":"OsahobI95r"}],"key":"QcIzbUqaKf"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Different nodes are randomly selected in each batch, improving generalization.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"MJAXGCT0bw"}],"key":"WN3dVQcTOt"}],"key":"ArQB1ihDpj"}],"key":"hXMpB5FLm2"}],"key":"N7dHe1KhJJ"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"The loss is computed ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"FlMN41p4da"},{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"only","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"t81Jh5ORI7"}],"key":"kFunibnQ5V"},{"type":"text","value":" for the nodes selected by the dynamic mask.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"KNCTqn02F4"}],"key":"cGDru1RvYo"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"IBDlp39OYb"},{"type":"heading","depth":3,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"üß™ Validation Function: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"O8PIf1UWoX"},{"type":"inlineCode","value":"validation()","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"G5UDM3yIyK"}],"identifier":"id-validation-function-validation","label":"üß™ Validation Function: validation()","html_id":"id-validation-function-validation","implicit":true,"key":"XadvEckLyv"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"During validation:","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"PHwphuqkXq"}],"key":"Y7r8aOldnd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We also ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"pRWONCKjlx"},{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"dynamically generate a new random mask","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"m82w1NPrsq"}],"key":"uFuaNXzCfJ"},{"type":"text","value":" per batch.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"E0eS8zq8u9"}],"key":"l3xNapFmXR"}],"key":"M8vydCarSG"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This ensures evaluation matches training conditions (masked input, selective supervision).","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"A2xTbwDcXh"}],"key":"rXFPG4yU4r"}],"key":"pu7WldPZLA"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gradients are disabled using ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"OvUIsRdEIg"},{"type":"inlineCode","value":"@torch.no_grad()","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"ASEap77A1K"},{"type":"text","value":" for efficiency.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"OcSdAJPG6i"}],"key":"hqv0SBz27L"}],"key":"cx05aQrAA6"}],"key":"HRQsvOcn4g"},{"type":"blockquote","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"‚ö° Note:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"VSRnXHeeK6"},{"type":"break","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"kbtCry87nu"},{"type":"text","value":"Message passing still uses the full graph (all nodes), but supervision happens ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"lYV9FKRyyn"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"only on the masked nodes","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"NlAYWlog3Z"}],"key":"hQrqhXXWHV"},{"type":"text","value":"!","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"MxV2Vwentg"}],"key":"Twx7kyM4gU"}],"key":"A1YSfBlrM9"},{"type":"thematicBreak","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Uf6eC4gscT"}],"key":"Ny8rBlRjy9"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"class EarlyStopper:\n    \"\"\"\n    A class for early stopping the training process when the validation loss stops improving.\n    \n    Parameters:\n    -----------\n    patience : int, optional (default=1)\n        The number of epochs with no improvement in validation loss after which training will be stopped.\n    min_delta : float, optional (default=0)\n        The minimum change in the validation loss required to qualify as an improvement.\n    \"\"\"\n    def __init__(self, patience=1, min_delta=0):\n        self.patience = patience\n        self.min_delta = min_delta\n        self.counter = 0\n        self.min_validation_loss = np.inf\n\n    def early_stop(self, validation_loss):\n        \"\"\"\n        Check if the training process should be stopped.\n        \n        Parameters:\n        -----------\n        validation_loss : float\n            The current validation loss.\n            \n        Returns:\n        --------\n        stop : bool\n            Whether the training process should be stopped or not.\n        \"\"\"\n        if validation_loss < self.min_validation_loss:\n            self.min_validation_loss = validation_loss\n            self.counter = 0\n        elif validation_loss > (self.min_validation_loss + self.min_delta):\n            self.counter += 1\n            if self.counter >= self.patience:\n                return True\n        return False\n    \n\ndef train(dataloader, device, mask_rate=0.1):\n    \"\"\"\n    Train the model with dynamic masking per batch.\n\n    Args:\n        dataloader : DataLoader ‚Äî training data.\n        device : torch.device\n        mask_rate : float ‚Äî fraction of nodes supervised per graph.\n\n    Returns:\n        mean_loss : float ‚Äî mean training loss across batches.\n    \"\"\"\n    model.train()\n    mean_loss = 0\n\n    for batch in dataloader:\n        batch = batch.to(device)\n\n        # Generate dynamic supervision mask BEFORE forward pass\n        mask = model.get_mask(batch.num_nodes, rate=mask_rate, device=device)\n\n        # Forward pass using masked input\n        out = model(batch.pos, batch.signal, batch.edge_index, batch.edge_attr, mask)\n\n        # Compute loss only on supervised nodes\n        loss = criterion(out[mask], batch.signal[mask])\n\n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\n        mean_loss += loss.item()\n\n    return mean_loss / len(dataloader)\n\n\n@torch.no_grad()\ndef validation(dataloader, device, mask_rate=0.1):\n    \"\"\"\n    Validate the model with dynamic masking per batch.\n\n    Args:\n        dataloader : DataLoader ‚Äî validation data.\n        device : torch.device\n        mask_rate : float ‚Äî fraction of nodes supervised per graph.\n\n    Returns:\n        mean_loss : float ‚Äî mean validation loss across batches.\n    \"\"\"\n    model.eval()\n    mean_loss = 0\n\n    for batch in dataloader:\n        batch = batch.to(device)\n\n        # üî• Generate dynamic supervision mask BEFORE forward pass\n        mask = model.get_mask(batch.num_nodes, rate=mask_rate, device=device)\n\n        # Forward pass using masked input\n        out = model(batch.pos, batch.signal, batch.edge_index, batch.edge_attr, mask)\n\n        # Compute loss only on supervised nodes\n        loss = criterion(out[mask], batch.signal[mask])\n\n        mean_loss += loss.item()\n\n    return mean_loss / len(dataloader)","visibility":"show","key":"wmaBS6p4MQ"},{"type":"outputs","id":"inmwg-fwLz8__DXA3xnH5","children":[],"visibility":"show","key":"s52UpPjl9F"}],"visibility":"show","key":"JSgXqFsalE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"‚öôÔ∏è Training Setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YsM6BsADYr"}],"identifier":"id-training-setup","label":"‚öôÔ∏è Training Setup","html_id":"id-training-setup","implicit":true,"key":"eTWxWIV9Z4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We now configure the components needed to train the model:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xS1ogHDrXU"}],"key":"I4nuXISVIT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Device Selection","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k10HhPxZ4W"}],"key":"Pmsi1EkVF0"},{"type":"break","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Dd84jp68sI"},{"type":"text","value":"Automatically use GPU (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hqVopIyn1s"},{"type":"inlineCode","value":"cuda:0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KsPYrxZqJV"},{"type":"text","value":") if available; otherwise fall back to CPU.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ll3JVpLYJr"}],"key":"ql4WVC8S0j"}],"key":"I1tw8my0SQ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Model Instantiation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WQIm1nqbyr"}],"key":"Q822Wvr7U6"},{"type":"break","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qO58MFeo6P"},{"type":"text","value":"Initialize the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k2EkxorEQG"},{"type":"inlineCode","value":"BasicNet","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"o9MlA5GaW2"},{"type":"text","value":" model with:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LUm3wnIhJG"}],"key":"QB907dCCC4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Positional feature size (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tTjUUQ9rLb"},{"type":"inlineCode","value":"data.pos.shape[1]","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HiymvANmVr"},{"type":"text","value":")","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"X6cEccc7Es"}],"key":"kiMQdfCef8"}],"key":"U8T2v93wL7"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Signal feature size (","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KAyYZRW4qr"},{"type":"inlineCode","value":"data.signal.shape[1]","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xvY4U8MYXG"},{"type":"text","value":")","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gLJ2tnLO3c"}],"key":"eR6vbrJQhR"}],"key":"U7YqbEHOBk"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hidden channels set to 64.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PXuDhRyK57"}],"key":"PruMB48loE"}],"key":"HhSvUUHZmG"}],"key":"a1cE7aqFmV"}],"key":"oeeMXAOq2o"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Loss Function","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JOzX42Mv6P"}],"key":"Z6CJLGvlx3"},{"type":"break","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"aXqK9G6GJp"},{"type":"text","value":"We use ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Jn1solwtxc"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Mean Squared Error (MSELoss)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"QRqsrvsUvW"}],"key":"UGERehc8Jt"},{"type":"text","value":" because the task is a regression problem (predicting continuous sine waves).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"R5poEGzZCK"}],"key":"mBPgPmzAsD"}],"key":"Jm9D1PkXLM"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Optimizer","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DaStjgIoE5"}],"key":"h620CE7vXF"},{"type":"break","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"bHQUjpN0un"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Adam optimizer","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hnMgXKf4TG"}],"key":"NLiXdntcwg"},{"type":"text","value":" is used for its efficiency and robustness in training deep models.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"X09ITSjX0X"}],"key":"xqOZZ2VLHM"}],"key":"Ivgc4MEO9M"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Early Stopping","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZUN0CNDh7o"}],"key":"m1dm7Bxhz3"},{"type":"break","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Nzta8TsRE4"},{"type":"text","value":"An ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"qFeIM2VHnM"},{"type":"inlineCode","value":"EarlyStopper","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"pjSCBnSoex"},{"type":"text","value":" is set up with:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"KYCnQi4Htr"}],"key":"rDgIkXgdfh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"patience=10","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ZhE88Q06dT"},{"type":"text","value":" (number of epochs without improvement before stopping)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"gMBXLPIGwP"}],"key":"WSE47IsD9p"}],"key":"AcsqC2U0EC"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"min_delta=0.0","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zx4tMqKBJs"},{"type":"text","value":" (smallest improvement to be considered progress)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"q0OQyEuHwB"}],"key":"uDstEloxoc"}],"key":"TfOGA2Ydzk"}],"key":"ism5rojewW"}],"key":"nyT8PCGovq"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Training State Variables","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Gd1kar8A4Y"}],"key":"wlNwwnHxAT"}],"key":"hS8NoI42x2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"loss_train","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"GeYKWu7YnL"},{"type":"text","value":" and ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"rjjIcTVlPy"},{"type":"inlineCode","value":"loss_val","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"U2hu7yDFCA"},{"type":"text","value":" store the loss history.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Iegt5ZGIWW"}],"key":"VGNPl7Qgp5"}],"key":"bNkvgOa7Mp"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"best_loss","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"y0mllrwfBS"},{"type":"text","value":" tracks the best validation loss seen so far.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"a5DCBEV5eZ"}],"key":"VzAGSeZjcp"}],"key":"C8GaAuv86t"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"PATH_CHECKPOINT","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"fYhGkMy39F"},{"type":"text","value":" defines where to save the best model weights.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"tbM0PHF3oe"}],"key":"YfkulHbE7m"}],"key":"CfSUfRoqoB"}],"key":"x35YprEoEb"}],"key":"hyrRgnbMUh"}],"key":"wB9GEzrjNL"},{"type":"thematicBreak","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"xDUwYQ5qD2"}],"key":"dFop2bp2lB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')\n# device = torch.device('cpu')\n\n\nmodel = BasicNet(data.pos.shape[1], data.signal.shape[1], hidden_channels=256).to(device)\n\ncriterion = torch.nn.MSELoss()  # Define loss criterion.\n# criterion = torch.nn.SmoothL1Loss()\noptimizer = torch.optim.Adam(model.parameters(), lr=0.001)  # Define optimizer.\nearly_stopper = EarlyStopper(patience=10, min_delta=0.0)\nloss_train = []\nloss_val = []\nbest_loss = 1\nbest_epoch = 0\nPATH_CHECKPOINT = \"./checkpoint/best_masked.pt\"\n# Create the folder if it doesn't exist\nos.makedirs(os.path.dirname(PATH_CHECKPOINT), exist_ok=True)\nmask_rate = 0.3\nmodel","visibility":"show","key":"QQ2AH02YOK"},{"type":"outputs","id":"Xsinh9Fz-b-TcjvEvxnqW","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"BasicNet(\n  (mlp_in): MLP(27, 256)\n  (conv): GATv2Conv(256, 256, heads=1)\n  (conv2): GATv2Conv(256, 256, heads=1)\n  (mlp_out): MLP(256, 25)\n)","content_type":"text/plain"}}},"children":[],"key":"oB3vAA2KDH"}],"visibility":"show","key":"OmdtLpUau7"}],"visibility":"show","key":"YBjb2ocXh9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üîÅ Training Loop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wiX7DHHBGM"}],"identifier":"id-training-loop","label":"üîÅ Training Loop","html_id":"id-training-loop-1","implicit":true,"key":"dLEl2MICUp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We now launch the model training:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FuSrcnhLka"}],"key":"pMerVdNx4p"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Loop over a maximum of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iKFtmve7XT"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"5000 epochs","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p77D4a1XJn"}],"key":"tHkAiomb9h"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"y9c4FXtp49"}],"key":"j7vF5FUXBj"}],"key":"RI3HJKqdw4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each epoch:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yRNHn0aE00"}],"key":"X9mGI2hVgt"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform a full pass over the training data and compute the mean training loss.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wV6Elv8G7A"}],"key":"LxhPE2kmJx"}],"key":"oENko4SWFk"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform a full pass over the validation data and compute the mean validation loss.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xhX7QvvkZx"}],"key":"em54VWQfUc"}],"key":"jldlZsATKk"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Update the training progress bar with the latest losses.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qEJYXHmliz"}],"key":"rWiOQJM4Ok"}],"key":"ZYUqbN2SUq"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If the validation loss improves, save the model checkpoint.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TnyKdtnLgC"}],"key":"Du4QKnqNCN"}],"key":"ABOuPiW3Hs"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If early stopping criteria are met, stop training early.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RpR4gHcxtg"}],"key":"wvyiLHoHdG"}],"key":"TfJbZF8Nzr"}],"key":"M2XZUw6Mow"}],"key":"jxxhT1nuST"}],"key":"XHQ1m3hEs9"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"üìà Monitoring:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"og5eH8DOBk"}],"identifier":"id-monitoring","label":"üìà Monitoring:","html_id":"id-monitoring","implicit":true,"key":"hUWF7XmYbn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We use ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"DPcTAfjOsd"},{"type":"inlineCode","value":"tqdm","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qhqw1hKE8V"},{"type":"text","value":" to display a live progress bar with the latest training and validation loss.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Dc6tE7zKKS"}],"key":"IrXqry8Ppy"}],"key":"I65ALmdM16"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"b8WY8KYpos"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"best model","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"IWLomN7dyJ"}],"key":"M3nEa6kzvX"},{"type":"text","value":" (lowest validation loss) is saved automatically to ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"PyP7FbFAoa"},{"type":"inlineCode","value":"PATH_CHECKPOINT","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"etstfwuoj0"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yGpjaXxkpX"}],"key":"vwAIuCNByG"}],"key":"llDZSWe3Vl"}],"key":"fAWvYwYebN"},{"type":"blockquote","position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vcK4wlhcsJ"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Reminder:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CyNjpGxPkU"}],"key":"dSRulYExcA"},{"type":"break","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yzuixRL9S7"},{"type":"text","value":"Dynamic masking is used both during training and validation, so different nodes are randomly supervised in every batch.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"J9y6O7QkQp"}],"key":"GFHU69cN3V"}],"key":"KUKppnROIE"},{"type":"heading","depth":3,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"üß† Input Masking Strategy: Preventing Cheating","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Xdbo0eWmG2"}],"identifier":"id-input-masking-strategy-preventing-cheating","label":"üß† Input Masking Strategy: Preventing Cheating","html_id":"id-input-masking-strategy-preventing-cheating","implicit":true,"key":"GRkPIZbv4W"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Unlike typical label masking or partial supervision,","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"NcsONRMi0R"},{"type":"break","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"JmyKgNbhNM"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"we use masking to deliberately corrupt node inputs","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"DPtSLlrfuz"}],"key":"qg6d4BxFrL"},{"type":"text","value":" during training.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"lqQpN1cAQv"}],"key":"HQSp1slelR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each training node, its ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"BuTLEVDmrH"},{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"own input signal is zeroed out","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"mzjIYtKgUI"}],"key":"wEoO6kXxB7"},{"type":"text","value":".","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"KbF2jEvPXn"}],"key":"XTJgLRZpkJ"}],"key":"XQLtC3WRUk"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"GipwoO6WZ9"},{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"cannot access its own signal","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"j8EJTYDEDV"}],"key":"mWTTqlxHav"},{"type":"text","value":" directly.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kWdShFeSIG"}],"key":"VKx2L4gDgr"}],"key":"BNmrdfZGpn"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It must ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"d8fcOjEKI7"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"reconstruct the missing signal","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"QFwm9VkNNl"}],"key":"IjTiM0ian3"},{"type":"text","value":" using ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"mzluDKuYiE"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"only its neighbors","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"x71CVhCepN"}],"key":"jfrFJWzqeK"},{"type":"text","value":" via message passing.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ANftR030kU"}],"key":"TC674tAwvB"}],"key":"Zv4lWcoOlw"}],"key":"yshNUC1rxv"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"‚úÖ All nodes still participate fully in the graph structure.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"TTtUaFfAIM"},{"type":"break","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bqYzAUUUNh"},{"type":"text","value":"‚úÖ Only the input features of supervised nodes are masked.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"r22UKeBeYP"}],"key":"U63u0gqkFr"},{"type":"thematicBreak","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"NiuwoQTjkp"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Training flow:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"OJjGrsByC4"}],"key":"kzSoI1GRG3"}],"key":"D1dtadtLyX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":35,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Full graph is built.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"JeC1JUg5sb"}],"key":"yiTxGxotCS"}],"key":"iMNTQYxCn7"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Input signal of supervised nodes is zeroed out.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"Lhnak9HnoQ"}],"key":"eHRGdyV9wH"}],"key":"KmHH51befv"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Message passing happens across the entire graph.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Di4D0rJv87"}],"key":"ZgBXB8wfty"}],"key":"XZsiW33hGg"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Loss is computed ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"sJJlkWJgez"},{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"only","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"SoyxuGHaft"}],"key":"x9lccNRyZu"},{"type":"text","value":" at the masked (supervised) nodes.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"slO14kiRhy"}],"key":"RbDhNJv8Dq"}],"key":"tAUEiYJsI8"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gradients update the model to better reconstruct missing signals.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"YReBWNunTe"}],"key":"sgYlm5irkw"}],"key":"CWump73Tub"}],"key":"jECmpOylob"},{"type":"thematicBreak","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"vp9VAJJ8W3"},{"type":"blockquote","position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"HMdt5VZ4gK"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"This approach forces the GNN to learn meaningful spatial patterns","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"NyKPj3CLQv"}],"key":"RzIusQary7"},{"type":"text","value":",","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"sqxyRMIjy2"},{"type":"break","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"lM5aWq6B3u"},{"type":"text","value":"and mimics real-world situations like seismic networks, GNSS, or sensor fields,","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"FSIGBOMAYX"},{"type":"break","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"bSRzFiJssF"},{"type":"text","value":"where some stations may be missing data and need to interpolate intelligently.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"CvwFsv6MhG"}],"key":"bQWX5pQNYy"}],"key":"YEEeEUV87L"},{"type":"thematicBreak","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"CcOpppBmdm"}],"key":"IZPw4cmC5B"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"start_time = time.perf_counter()\n\nnb_epoch = tqdm(range(20))\n\nfor epoch in nb_epoch:\n    loss_train.append(train(train_loader, device, mask_rate))\n    loss_val.append(validation(val_loader, device, mask_rate))\n    \n    if loss_val[-1] < best_loss:\n        best_loss = loss_val[-1]\n        best_epoch = epoch\n        torch.save(model.state_dict(), PATH_CHECKPOINT)\n    if early_stopper.early_stop(loss_val[-1]):\n        print(f\"early stopping at epoch {epoch}: train loss={loss_train[-1]}, val loss={loss_val[-1]}\")\n        break\n    nb_epoch.set_postfix_str(f\"train loss={loss_train[-1]}, val loss={loss_val[-1]}\")","visibility":"show","key":"Pb8t4IGRSQ"},{"type":"outputs","id":"OoE9sCkfD9WhqwlfKusO5","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 20/20 [02:08<00:00,  6.41s/it, train loss=0.17703746424780953, val loss=0.17709419876337051]\n"},"children":[],"key":"tQbuCKmRZT"}],"visibility":"show","key":"qSgw8bP7Jc"}],"visibility":"show","key":"v2BBwRYLKQ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(loss_train, label=\"Train\")\nplt.plot(loss_val, label = \"Validation\")\nplt.legend(loc='center left', bbox_to_anchor=(1, 0.5))","visibility":"show","key":"W5Tl1LlKlq"},{"type":"outputs","id":"2PyHR8moZRKCCihLA5HTY","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d3ae2ead6a367816c4ecb131a47a79d7","path":"/d3ae2ead6a367816c4ecb131a47a79d7.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"jTzfpqxKeG"}],"visibility":"show","key":"YemNzPvNHM"}],"visibility":"show","key":"VW4yT17e0o"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üß™ Model Evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y7zREe5KqF"}],"identifier":"id-model-evaluation","label":"üß™ Model Evaluation","html_id":"id-model-evaluation","implicit":true,"key":"wwra5q7v9q"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After training, we evaluate the model‚Äôs performance on the test set.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EWGN6f43sf"}],"key":"jIaZkbuxjN"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"üéØ Evaluation Goals:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VJs58ykQif"}],"identifier":"id-evaluation-goals","label":"üéØ Evaluation Goals:","html_id":"id-evaluation-goals","implicit":true,"key":"kipF6xGDZT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Measure how well the model can ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eo9O0hiMOL"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"predict the full sine wave at each node","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QLUEosMnqs"}],"key":"CnlagV5aEV"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JRd0VfeuhW"}],"key":"oWRXfV9uZz"}],"key":"ZkMyWoJtw6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Assess overall performance with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kswRlp6Esg"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"quantitative metrics","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Oppd7SHKI7"}],"key":"jn4T7yaaAt"},{"type":"text","value":" (like Mean Absolute Error).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YJbOlBT6XB"}],"key":"hi8H9nAfyh"}],"key":"Q53ffeBNLG"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Visualize","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"s2LPGtVFJC"}],"key":"VtL7is72cR"},{"type":"text","value":" individual predictions to qualitatively inspect model behavior.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VWOzVWz536"}],"key":"ILP3QjtErw"}],"key":"PWoIlBGRNJ"}],"key":"vmRBAYpxAZ"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"üö¶ Key Differences from Training:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vmENECucCJ"}],"identifier":"id-key-differences-from-training","label":"üö¶ Key Differences from Training:","html_id":"id-key-differences-from-training","implicit":true,"key":"BcXIYczNaF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"No dynamic masking during evaluation","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VPgS1KEAxK"}],"key":"P4zODzaLXy"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"DIAJy5Jns9"}],"key":"W9czW7bfjO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We want to predict the full signal at every node, not just a subset.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sv74Ye9mQG"}],"key":"E13u7xgog6"}],"key":"ycuqGeQhW2"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A mask of all ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"L50MHkxrZf"},{"type":"inlineCode","value":"False","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LCUVDWUXIu"},{"type":"text","value":" values is passed to the model to disable input corruption.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"j19rl84QN6"}],"key":"n4GXLSVUOi"}],"key":"RbK9repsKQ"}],"key":"u8oxHfUxLG"}],"key":"dTL8pygEQW"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Full supervision","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ZjTyQVFpbl"}],"key":"N6wNTHR2RY"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"aUIunKZebr"}],"key":"Gn6isy97C4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The loss and metrics are computed across ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BLbskL2eoY"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"all nodes","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"SZsXP9oaQT"}],"key":"EwFZqchDkp"},{"type":"text","value":" without random sampling.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XUu5UNuyOT"}],"key":"WTx6P6yHfi"}],"key":"ecm6VKReTE"}],"key":"Qd9AfHYX6D"}],"key":"pgzRFJmsDg"}],"key":"K5Bu3JzJkq"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"üìä Evaluation Metrics:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"noCkvVGdMu"}],"identifier":"id-evaluation-metrics","label":"üìä Evaluation Metrics:","html_id":"id-evaluation-metrics","implicit":true,"key":"etq4tHeo1z"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Mean Absolute Error (MAE)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"IGBa6yDSTA"}],"key":"e55Ybe308P"},{"type":"text","value":":","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"cCWeY8mr5F"},{"type":"break","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TpYipeRx3N"},{"type":"text","value":"Measures the average absolute difference between predicted and true signals at each node.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pjvNyQazWR"}],"key":"iSQuEQrKCk"}],"key":"EBxi6a7mhJ"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Histogram of per-node errors","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"eJ7K6KjH6e"}],"key":"f2ihZzr8IG"},{"type":"text","value":":","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"JUGB4y56tQ"},{"type":"break","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"iu5NTaRuXx"},{"type":"text","value":"Helps understand the distribution of prediction errors across the entire test set.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"KhMwOTYM3d"}],"key":"fGgi4mZo2L"}],"key":"Onu70nzrah"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Qualitative plots","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"HT5YlrZzhF"}],"key":"THjhVm9A0T"},{"type":"text","value":":","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Mc2YNPo8Fi"},{"type":"break","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PCS9G0anYH"},{"type":"text","value":"Overlay predicted and true sine waves for random sample nodes to visually inspect performance.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"J6VZCo3wC9"}],"key":"JV7H4tyFUr"}],"key":"tpS3my6h9X"}],"key":"ewLWAeUuT8"},{"type":"blockquote","position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"uOQRKHealN"},{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Reminder:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SXglATTC57"}],"key":"GuZfIocy2G"},{"type":"break","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"kchMBup0YI"},{"type":"text","value":"Even though the model was trained with incomplete (masked) signals, during evaluation we test its ability to recover the entire signal at every node.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"JAa5SFWnsL"}],"key":"ZdjvIXsqj4"}],"key":"h2Quuxj6H7"},{"type":"thematicBreak","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"R9xCWJQiti"}],"key":"GtRAiOfUMq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# restore best model\n# PATH_CHECKPOINT = \"./checkpoint/best_masked.pt\"\n\n# actually use a pretrained one on GPU\nPATH_CHECKPOINT = \"./best_node_reg.pt\"\nmodel.load_state_dict(torch.load(PATH_CHECKPOINT, map_location='cpu'))\nprint(f\"best loss={best_loss}, model eval loss={validation(val_loader, device, mask_rate)} at epoch {best_epoch}\")","visibility":"show","key":"zzyqMdXujz"},{"type":"outputs","id":"BS-7-VtAEAgCGcPKtg8Rl","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"best loss=0.17709419876337051, model eval loss=0.11411901749670506 at epoch 19\n"},"children":[],"key":"WuWKZyXxQ7"}],"visibility":"show","key":"KzOQ3Z2B4Y"}],"visibility":"show","key":"ukA3WT9LPi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Evaluation Function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rvYMB5oA1g"}],"identifier":"id-evaluation-function","label":"üõ†Ô∏è Evaluation Function","html_id":"id-evaluation-function","implicit":true,"key":"TJ7WdmBeT2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We define an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a7d2uRdKaR"},{"type":"inlineCode","value":"evaluate()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uHLAmT55f6"},{"type":"text","value":" function to test the model‚Äôs performance on the full test set.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"spXP5kdQan"}],"key":"DBIhSLMRAo"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Key differences compared to training:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J1Gn1pNuqv"}],"key":"QQlZ3ICEOM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"No dynamic masking","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CrTUgwguvz"}],"key":"gSepqxa4pl"},{"type":"text","value":":","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lKdOWHJ6Sp"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Iqs4raexjn"},{"type":"text","value":"We pass a ‚Äúno mask‚Äù (all ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oaE0macrMb"},{"type":"inlineCode","value":"False","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dovxUF1Nky"},{"type":"text","value":") tensor to the model. This ensures ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cUkjD4DBid"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"full input signals","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dJG2qspnzq"}],"key":"QM1iMVDmq7"},{"type":"text","value":" are used for prediction.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xiCNISALM2"}],"key":"lqSEYZqDc3"}],"key":"Lx3Ssu1PUY"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Full node supervision","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CXf7q2V9x6"}],"key":"kTATKMnPkQ"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wh5I8XciV4"},{"type":"break","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WCgEMJphL7"},{"type":"text","value":"The loss and metrics are computed across ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"FAPlEEtM5T"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"all nodes","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KZW1HhGGzF"}],"key":"MZplewFTKH"},{"type":"text","value":", not just a random subset.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"huXADJm7Dy"}],"key":"rw1AFfxfOO"}],"key":"t5g9zsmEf4"}],"key":"y1UGJ4maqR"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üìã Function Behavior:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wsRkLjRsB1"}],"identifier":"id-function-behavior","label":"üìã Function Behavior:","html_id":"id-function-behavior","implicit":true,"key":"wULlOg2kHY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform a forward pass through the model for each batch in the test set.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"UHG8hQfr7Y"}],"key":"ulDnpAQwIL"}],"key":"emm0anvXHj"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fUup3UzzyN"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Mean Absolute Error (MAE)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"g8K71Q6Yax"}],"key":"Josjc6VzMZ"},{"type":"text","value":" for each batch.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"T7NIxTNxGs"}],"key":"OGuWN4wmVp"}],"key":"Kzf0SueCko"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Stack all predicted signals and ground truth signals for further visualization.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Q2Y1gN7CWq"}],"key":"yoHrh9eNus"}],"key":"ZSBWc5NxoZ"}],"key":"sJXmfDHOkR"},{"type":"heading","depth":3,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"üì§ Function Outputs:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ZbMcHf6J6s"}],"identifier":"id-function-outputs","label":"üì§ Function Outputs:","html_id":"id-function-outputs","implicit":true,"key":"fCFn2nVE1g"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"mean_mae","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"PjdaQYJGV1"}],"key":"ZZtqfYBBxg"},{"type":"text","value":": Average Mean Absolute Error across all nodes in the test set.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"y7VIwqAO5m"}],"key":"jsKnGp5N8I"}],"key":"HPzcPQFj9k"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"inlineCode","value":"pred_all","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tDAoFvrk0o"}],"key":"pCNzOvBapL"},{"type":"text","value":": Stacked predictions for all nodes.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Ai3KIx0bxx"}],"key":"VukBpRTrJ7"}],"key":"MyLRUDM6O5"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineCode","value":"true_all","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IgQEK2o5L0"}],"key":"V31bpL1eH7"},{"type":"text","value":": Stacked ground truth sine waves for all nodes.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zng9CEYmgU"}],"key":"o2n14UC6lv"}],"key":"cIxCkNCthZ"}],"key":"mRBAx9ICgR"},{"type":"blockquote","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"lXf6BLt3eE"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Reminder:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"R5nbX1tC1O"}],"key":"qSAc1pjcuY"},{"type":"break","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"u5j3pJ447L"},{"type":"text","value":"Evaluating on full signals allows us to truly assess how well the model reconstructs complete sine waves at each node.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"VQxV1SDOju"}],"key":"vRtH3yMbOw"}],"key":"TEA2upFCPZ"}],"key":"SCSVd5iGJT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@torch.no_grad()\ndef evaluate(model, dataloader, device):\n    \"\"\"\n    Evaluate the model on the full test set without dynamic masking.\n\n    Args:\n        model : Trained model\n        dataloader : DataLoader for the test set\n        device : torch.device\n\n    Returns:\n        mean_mae : float ‚Äî Mean Absolute Error across all nodes\n        pred_all : Tensor ‚Äî Predicted signals (stacked) [num_nodes, signal_size]\n        true_all : Tensor ‚Äî Ground truth signals (stacked) [num_nodes, signal_size]\n    \"\"\"\n    model.eval()\n    total_mae = 0\n    pred_all = []\n    true_all = []\n\n    for batch in dataloader:\n        batch = batch.to(device)\n\n        # Create a zero mask ‚Üí No input corruption during final evaluation\n        no_mask = torch.zeros(batch.num_nodes, dtype=torch.bool, device=device)\n\n        # Forward pass\n        out = model(batch.pos, batch.signal, batch.edge_index, batch.edge_weight, no_mask)\n\n        # Accumulate outputs\n        pred_all.append(out.cpu())\n        true_all.append(batch.signal.cpu())\n\n        # Calculate MAE for the batch\n        batch_mae = torch.mean(torch.abs(out - batch.signal))\n        total_mae += batch_mae.item()\n\n    # Aggregate\n    mean_mae = total_mae / len(dataloader)\n    pred_all = torch.cat(pred_all, dim=0)\n    true_all = torch.cat(true_all, dim=0)\n\n    return mean_mae, pred_all, true_all\n","key":"AeIz3kWVbO"},{"type":"outputs","id":"V9DVIUbshZhsMkCYl_b-b","children":[],"key":"feNmoGG5Ex"}],"key":"Bzpd3DDanS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üîç Prediction and Visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h14y2tQy9v"}],"identifier":"id-prediction-and-visualization","label":"üîç Prediction and Visualization","html_id":"id-prediction-and-visualization","implicit":true,"key":"uzYqFPJH2k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After evaluating the model numerically, it is crucial to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D11w8nQa9g"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"visualize","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ccTlGUWnD1"}],"key":"UMJ09iAbc2"},{"type":"text","value":" how well it is reconstructing the node-level sine waves.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"naYzFfMfOn"}],"key":"bBX1SKbjMR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We perform two types of visual inspections:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s6X9AuiaQT"}],"key":"ZcCKAJtK3R"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"e3gVUn2Dbf"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"üéØ 1. Random Node Signal Comparison","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oaWyErZuOd"}],"identifier":"id-1-random-node-signal-comparison","label":"üéØ 1. Random Node Signal Comparison","html_id":"id-1-random-node-signal-comparison","implicit":true,"key":"HghO5CCVCQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Randomly select a few nodes from the test set.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JbYVDs1wVH"}],"key":"ctHLsiS1wM"}],"key":"hI4xufCCWS"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plot both the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tx7b2F8IBT"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"true sine wave","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"mCO7jKbmWi"}],"key":"ngart38omV"},{"type":"text","value":" and the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"TgtNa9zsTP"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"predicted sine wave","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"G4UXUcqJGX"}],"key":"wIISvemxlT"},{"type":"text","value":" for each node.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"v0niSI0fsO"}],"key":"J0RelQTBpg"}],"key":"vUM6fNCrhK"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This helps us visually inspect how well the model captures the correct waveform shapes.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cUBHUFuLYg"}],"key":"MvnZc6TizT"}],"key":"JHK2EbbgLB"}],"key":"wlXlCWAJBf"},{"type":"blockquote","position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"üß† ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yVni4fuojq"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Note:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"qopVweKeiz"}],"key":"MfkUxSC7Mr"},{"type":"break","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hbPtH45kD7"},{"type":"text","value":"Perfect predictions would show overlapping dashed (true) and solid (predicted) lines.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"SAwhba6Ooo"}],"key":"IwKVrVb0lr"}],"key":"Iidel5b5O3"},{"type":"thematicBreak","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"eLhELaV0tk"},{"type":"heading","depth":3,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"üìä 2. Histogram of Node Prediction Errors","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NJk1u7HdgU"}],"identifier":"id-2-histogram-of-node-prediction-errors","label":"üìä 2. Histogram of Node Prediction Errors","html_id":"id-2-histogram-of-node-prediction-errors","implicit":true,"key":"gt2S7dbk2j"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute the ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"q2f4C0BwCe"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"L2 norm","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XWTDRO2FEr"}],"key":"kLt1IFVPlP"},{"type":"text","value":" (Euclidean distance) between the predicted and true signals at each node.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"bo6B2QFdeU"}],"key":"T3ZhaFbwYp"}],"key":"d2xUYm4JmP"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plot a histogram showing the distribution of node-wise errors across the entire test set.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"c8lpuck58X"}],"key":"QKUxGWUPci"}],"key":"U27sj4PMQA"}],"key":"dZQJEq4RZr"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"This helps answer questions like:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"fB35Cs7I8w"}],"key":"RiXWbgBI24"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Are most predictions very close?","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"zy7MZDyBn9"}],"key":"LReFibuVpc"}],"key":"drCkzIDhmR"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Are there occasional large errors (outliers)?","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ujYmxL1mss"}],"key":"Gkkd8uRcmJ"}],"key":"wndkXrbYs4"}],"key":"PbYHLPUCQh"},{"type":"blockquote","position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"üö¶ ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"gWBf9Q87lq"},{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Goal:","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ra5CCRABth"}],"key":"J65Txf3s8y"},{"type":"break","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ysSkcp9mtN"},{"type":"text","value":"Ideally, the histogram is ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"PLOXoVNAw7"},{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"skewed toward small errors","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"okVJJXyDlK"}],"key":"YWGdcAB4r5"},{"type":"text","value":", indicating most nodes are well predicted!","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"owEijhRTxG"}],"key":"YIgfsEs2Hi"}],"key":"OXD2FXbK6J"},{"type":"thematicBreak","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"fI0Ia1ujW9"}],"key":"qm77DzWACj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Predict and gather outputs ---\nmean_mae, pred_all, true_all = evaluate(model, test_loader, device)\n\nprint(f\"Mean Absolute Error (MAE) on Test Set: {mean_mae:.4f}\")","key":"v1acjgTuKO"},{"type":"outputs","id":"c8YB6u7SXL9pcm2VZbD1f","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Mean Absolute Error (MAE) on Test Set: 0.3279\n"},"children":[],"key":"v7xaUTLIi8"}],"key":"a1SW67SJtD"}],"key":"BihWz5tLnp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Compute per-node L2 errors ---\nnode_errors = torch.norm(pred_all - true_all, dim=1).numpy()\n\n# --- Estimate random prediction baseline ---\n# Random predictions between -1 and 1 (since tanh activation output is bounded)\nrand_preds = 2 * torch.rand_like(true_all) - 1  # Uniform random between [-1, 1]\nrand_errors = torch.norm(rand_preds - true_all, dim=1).numpy()\nexpected_random_error = rand_errors.mean()\n\npred_0 = torch.zeros(true_all.shape)\npred_0_errors = torch.norm(pred_0 - true_all, dim=1).numpy()\nexpected_pred_0_error = pred_0_errors.mean()\n\n# --- Plot\nplt.figure(figsize=(8, 5))\nplt.hist(node_errors, bins=30, alpha=0.7, color='teal', edgecolor='black', label=\"Model Prediction Errors\")\nplt.axvline(expected_random_error, color=\"red\", linestyle=\"--\", linewidth=2, label=f\"Random baseline: {expected_random_error:.2f}\")\nplt.axvline(expected_pred_0_error, color=\"black\", linestyle=\"--\", linewidth=2, label=f\"0 baseline: {expected_pred_0_error:.2f}\")\n\nplt.xlabel(\"L2 Error per Node\")\nplt.ylabel(\"Frequency\")\nplt.title(\"Histogram of Node Prediction Errors\")\nplt.legend()\nplt.grid(True, linestyle=\"--\", alpha=0.5)\nplt.tight_layout()\nplt.show()","key":"mkpojagMQ3"},{"type":"outputs","id":"B41I8kOW41EwMAzEm-m_O","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"62b94eb0dd8d65992d566ab0d88c984b","path":"/62b94eb0dd8d65992d566ab0d88c984b.png"},"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"YKJCrqa8sv"}],"key":"G0eXmOrKOW"}],"key":"mNVJMFqTSS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Pick random nodes ---\nnum_samples = 9\nrandom_indices = random.sample(range(pred_all.shape[0]), num_samples)\n\nfig, axs = plt.subplots(3, 3, figsize=(15, 8))\naxs = axs.flatten()\n\nfor i, idx in enumerate(random_indices):\n    axs[i].plot(true_all[idx].numpy(), label=\"True Signal\", linestyle='--')\n    axs[i].plot(pred_all[idx].numpy(), label=\"Predicted Signal\", linestyle='-')\n    axs[i].set_title(f\"Node {idx}\")\n    axs[i].legend()\n    axs[i].grid(True, linestyle=\"--\", alpha=0.5)\n\nplt.suptitle(\"Predicted vs True Sine Waves at Random Nodes\", fontsize=16)\nplt.tight_layout(rect=[0, 0, 1, 0.95])\nplt.show()","key":"wXWu5EAovy"},{"type":"outputs","id":"JWbIozdzwfZTIWxBolqqe","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"576db37dffc3638d1a328567738f66ba","path":"/576db37dffc3638d1a328567738f66ba.png"},"text/plain":{"content":"<Figure size 1500x800 with 9 Axes>","content_type":"text/plain"}}},"children":[],"key":"hkTd0DeWcm"}],"key":"drel5L8PJU"}],"key":"U76PhHaIel"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üåê Spatial Visualization of Node Errors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LewZw7qojR"}],"identifier":"id-spatial-visualization-of-node-errors","label":"üåê Spatial Visualization of Node Errors","html_id":"id-spatial-visualization-of-node-errors","implicit":true,"key":"FZd9M82lVi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To better understand where the model performs well (or poorly),","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UlHyN1u8mr"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cWoxgISJVl"},{"type":"text","value":"we visualize the spatial distribution of node-level errors across multiple random test graphs.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZQarHhbcd2"}],"key":"uwd97OFfYG"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"For each selected graph:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ruktSqJYh5"}],"key":"dkVui65nLs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Nodes","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IlCSgdiNKy"}],"key":"Rhnw8A1eKG"},{"type":"text","value":" are colored according to their ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"i5lhOp1u1y"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Mean Absolute Error (MAE)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WR3ShT75QU"}],"key":"Z1OZhMYU3G"},{"type":"text","value":" between predicted and true signals.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q5VfKfIi3M"}],"key":"mppAml58tf"}],"key":"ebtBtWTYXN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Edges","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MShutY3d7S"}],"key":"mVTr4b8eKN"},{"type":"text","value":" are shown in light gray to illustrate graph connectivity.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hIji73cLHc"}],"key":"I8oNMiShTK"}],"key":"LnNEjSqJA4"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A colorbar indicates the magnitude of error at each node.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BIaBLc0fNV"}],"key":"DQvUljnExx"}],"key":"Qc3ZYC6sV3"}],"key":"dociGQyIs3"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üß† Interpretation:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"D46IJxxPRN"}],"identifier":"id-interpretation","label":"üß† Interpretation:","html_id":"id-interpretation","implicit":true,"key":"iuTrReDJtm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lower-error nodes (dark blue) suggest the model can accurately reconstruct the signal.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QMQIxQUHmB"}],"key":"W56a0PvJWE"}],"key":"ZlajzodMEv"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Higher-error nodes (yellow/green) highlight more challenging areas.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MIEWqxJskF"}],"key":"BmiG9gUmYI"}],"key":"dy5Vy3UxXu"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"By comparing graphs, we can investigate if node ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"M7dcxzEOiF"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"density","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"R2iU5T0ARJ"}],"key":"zdhYSowirO"},{"type":"text","value":" and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"cV0RtbTrtk"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"connectivity","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"VRuaIRVTO7"}],"key":"rNLADKAYJA"},{"type":"text","value":" correlate with prediction quality.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CMsKcqpZEE"}],"key":"b22NFZc8Ek"}],"key":"Y55Eu8Nzrp"}],"key":"tVJhP3XmR5"},{"type":"blockquote","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"üîç ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RbkwyXNYTa"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Hypothesis:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nyPQx3sbiU"}],"key":"QrsH9lVT2e"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"M6sIVzHsER"},{"type":"text","value":"Nodes in densely connected areas should have lower errors, as the model can better leverage neighbor information.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"k4qb1uJTcC"}],"key":"UHzuZoVFlN"}],"key":"nmUf5hqejs"},{"type":"thematicBreak","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DgN1c582Jp"}],"key":"R4dghhuq8n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Sample 9 graphs randomly ---\nsample_graph_indices = random.sample(range(len(test_dataset)), 9)\n\nfig, axs = plt.subplots(3, 3, figsize=(18, 14))\naxs = axs.flatten()\n\nnode_pointer = 0\n\nfor i, graph_idx in enumerate(sample_graph_indices):\n    g = test_dataset[graph_idx]\n    num_nodes = g.pos.shape[0]\n\n    # Extract predictions and truths for this graph\n    preds = pred_all[node_pointer:node_pointer + num_nodes]\n    trues = true_all[node_pointer:node_pointer + num_nodes]\n\n    # Compute per-node MAE\n    node_errors = torch.mean(torch.abs(preds - trues), dim=1).numpy()\n\n    # --- Use the new helper to plot into specific axis\n    visualize_graph_torch(\n        g,\n        node_values=node_errors,\n        cmap=\"plasma\",\n        ax=axs[i],\n        title=f\"Graph {graph_idx} ‚Äî Node Errors\"\n    )\n\n    node_pointer += num_nodes\n\n# Hide any unused subplots (shouldn't happen since we picked exactly 9)\nfor j in range(len(sample_graph_indices), len(axs)):\n    axs[j].axis('off')\n\nplt.suptitle(\"Node MAE Errors Across Random Test Graphs\", fontsize=20)\nplt.tight_layout(rect=[0, 0, 1, 0.95])\nplt.show()\n","key":"VFbtEDMXed"},{"type":"outputs","id":"9se5dy8iMDGiYESBTwtq_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e6eccd5def3556e2b7f580e1eed32b9b","path":"/e6eccd5def3556e2b7f580e1eed32b9b.png"},"text/plain":{"content":"<Figure size 1800x1400 with 18 Axes>","content_type":"text/plain"}}},"children":[],"key":"sLAkwiQ86D"}],"key":"zObx8e3bqJ"}],"key":"AMArq2czAp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üèÅ Conclusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WAsNhFQymo"}],"identifier":"id-conclusion","label":"üèÅ Conclusion","html_id":"id-conclusion","implicit":true,"key":"FFiNVKcI0k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this notebook, we built and trained a Graph Neural Network (GNN) model for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xHxjF1FH9O"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"node-level sine wave reconstruction","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lSQtkfXcJy"}],"key":"LjI81wcp1K"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ni6Bv4dg0m"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k4tDOJEes1"},{"type":"text","value":"We covered the full workflow:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UP3tufcdbI"}],"key":"FJgrGdXk7Z"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"üõ†Ô∏è Built a synthetic dataset with sine wave signals delayed by spatial distance.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"e8HSCN5p2y"}],"key":"nULSPk1v19"}],"key":"Sa6Y6DycyA"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"üß† Designed a custom GNN model (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wnT5UOXDH4"},{"type":"inlineCode","value":"BasicNet","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zd8vw1bazL"},{"type":"text","value":") combining signal feature extraction and attention-based message passing.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"b0Eh5FJvZC"}],"key":"KstyuoRFLI"}],"key":"gHVhV9IE00"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"üéØ Trained the model using ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"olKcWH5CKO"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"dynamic masking","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KiILFsHlRQ"}],"key":"Cu0AkccEuB"},{"type":"text","value":" to simulate incomplete input signals.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sA3M990fEw"}],"key":"PlbmKjvPxo"}],"key":"VeTwEsbEnS"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"üìà Monitored training with early stopping and validation loss tracking.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ui44d4oaiR"}],"key":"S84AqJVs5a"}],"key":"JNHLpqTXI2"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"üß™ Evaluated performance using:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TjNG8mLLRA"}],"key":"L3qWELL60A"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Mean Absolute Error (MAE)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jUBJVCVOts"}],"key":"h91HnGfUR6"}],"key":"UtW2N2OFbU"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"True vs Predicted signal plots","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ezKTFeAkaT"}],"key":"NWqJsSTndL"}],"key":"ttLh3BdEed"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Histogram of node prediction errors","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"E4X0HxfpSu"}],"key":"ZQmFrpfrVV"}],"key":"rrZmjTGnm2"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Spatial visualizations of node-level errors across graphs","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"HkoVYqUafH"}],"key":"zsGfHPXiXU"}],"key":"ZJInQdXiYG"}],"key":"Pv9lsGt7Ae"}],"key":"rNHUDtWZGe"}],"key":"ayqLoQLUzZ"},{"type":"thematicBreak","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"YikDWQtrmq"},{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"üöÄ Key Takeaways:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"y1gAtJ7X9Q"}],"identifier":"id-key-takeaways","label":"üöÄ Key Takeaways:","html_id":"id-key-takeaways","implicit":true,"key":"pSJVdj4e6Q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"GNNs can effectively reconstruct node-level signals even when only partial inputs are available.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"RimSNdbapg"}],"key":"AJpylwrdMe"}],"key":"d0ZBsfHrJV"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Dense graphs (with strong neighbor connectivity) generally lead to better local predictions.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"kPlVoslT44"}],"key":"ISRzaXGFh4"}],"key":"tFlVtgqk93"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualization tools are crucial for both debugging and interpreting GNN behavior.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"urCqxsy6oc"}],"key":"LZ4Fbq9Ygd"}],"key":"XBRksAmYSN"}],"key":"coQvm1XtEU"},{"type":"thematicBreak","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HJQDVKAv6k"},{"type":"heading","depth":3,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"üîÆ Possible Extensions:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"CfbP0EDReO"}],"identifier":"id-possible-extensions","label":"üîÆ Possible Extensions:","html_id":"id-possible-extensions","implicit":true,"key":"jMbd4VEO3D"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Test deeper GNN architectures (e.g., stacking multiple GATv2 layers).","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xn2eSicgGY"}],"key":"NvyG3XVbyw"}],"key":"FW8qjDkiGT"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Enrich edge features (e.g., relative positions, arrival time differences).","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"lAKlgceZl0"}],"key":"jscJoUTfp1"}],"key":"ud4aqyQwQr"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Experiment with different dynamic masking rates during training.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"WL9k4zsR1i"}],"key":"zZfx9Ei1J8"}],"key":"J4lvMwOYNu"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore more realistic datasets where node features evolve over time.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"rjKAhPllaz"}],"key":"yv9Nl96oUg"}],"key":"aVE9K3QhgU"}],"key":"MZQCBFd0dy"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ZcUTQECHUP"},{"type":"heading","depth":3,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"üìö Want to see GNNs applied to real geophysical data?","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"yobESnNIsG"}],"identifier":"id-want-to-see-gnns-applied-to-real-geophysical-data","label":"üìö Want to see GNNs applied to real geophysical data?","html_id":"id-want-to-see-gnns-applied-to-real-geophysical-data","implicit":true,"key":"THUaiw7JaP"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"If you‚Äôre interested in how Graph Neural Networks can be used beyond synthetic examples,","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"PwUWgcu0ge"},{"type":"break","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"faKlz1Us85"},{"type":"text","value":"check out our recent work applying GNNs to ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ocUtX0hl80"},{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"denoise real daily GNSS time series","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"BGtaddohrS"}],"key":"yaTyQf11bk"},{"type":"text","value":" in the Cascadia subduction zone:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"eGqLs5P2OU"}],"key":"RRFItKHLMt"},{"type":"blockquote","position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Bachelot, L., Thomas, A. M., Melgar, D., Searcy, J., & Sun, Y.-S. (2025).","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"mlIiLsBJCu"}],"key":"ibwAKe3uUt"},{"type":"break","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"iF2BKr4W77"},{"type":"emphasis","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Cascadia Daily GNSS Time Series Denoising: Graph Neural Network and Stack Filtering.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Fz4PaQXLom"}],"key":"OHrvQz61cU"},{"type":"break","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"NpDov6xc0R"},{"type":"text","value":"Seismica, 2(4). ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"l8UD3SiP1j"},{"type":"cite","url":"https://doi.org/10.26443/seismica.v2i4.1419","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Bachelot ","key":"JjPXV5g0Mo"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"kO2WYEbtem"}],"key":"bRuxMl9nio"},{"type":"text","value":" (2025)","key":"KN2ybdX6u7"}],"kind":"narrative","label":"Bachelot_2025","identifier":"https://doi.org/10.26443/seismica.v2i4.1419","enumerator":"1","key":"KCif2wmwRS"}],"key":"Iau9BPvk3c"}],"key":"GNYo34tNkh"},{"type":"thematicBreak","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"kNtekvMuHZ"}],"key":"UjRTliA7LZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"bqYgn0xQJC"},{"type":"outputs","id":"GwZBVU1_xeUY5o6EPg-dB","children":[],"key":"zrjupxZqax"}],"key":"QUoi0mrNwu"}],"key":"ifXxyj9cBW"},"references":{"cite":{"order":["Bachelot_2025"],"data":{"Bachelot_2025":{"label":"Bachelot_2025","enumerator":"1","doi":"10.26443/seismica.v2i4.1419","html":"Bachelot, L., Thomas, A., Melgar, D., Searcy, J., & Sun, Y.-S. (2025). Cascadia Daily GNSS Time Series Denoising: Graph Neural Network and Stack Filtering. <i>Seismica</i>, <i>2</i>(4). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.26443/seismica.v2i4.1419\">10.26443/seismica.v2i4.1419</a>","url":"https://doi.org/10.26443/seismica.v2i4.1419"}}}}}