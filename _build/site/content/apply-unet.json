{"version":3,"kind":"Notebook","sha256":"bcb70c9762335c2dd339fd5bae03754159bfd66309b7592f65d988d002c5a9a4","slug":"apply-unet","location":"/notebooks/Amanda/apply_unet.ipynb","dependencies":[],"frontmatter":{"title":"Applying the U-Net to real seismic data (detections the hard way)","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"pytorch","language":"python"},"authors":[{"id":"Amanda M. Thomas, William Marfo, and Loïc Bachelot","name":"Amanda M. Thomas, William Marfo, and Loïc Bachelot"}],"keywords":["earthquake","catalog","ML","AI"],"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"apply_unet.ipynb","url":"/apply_unet-d7102d8646ff6e67ede0f7c634acf08c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DR05GPh6XC"}],"key":"xHnxMPlEiZ"},{"type":"text","value":" Amanda M. Thomas","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NpGwDB5hnC"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PKoOYVKIeQ"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Goal:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RPgEXEVqhy"}],"key":"ZbQSKerKKc"},{"type":"text","value":" In this notebook we will once again build the U-Net but this time instead of training we simply load in the model weights we saved after training.  We then apply the trained model to data from NCEDC stations that recorded the 2022 Ferndale earthquake.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TuNsEqMs6i"}],"key":"ViLg0Q0ybY"}],"key":"JWQ1gDSOiV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom torchinfo import summary","key":"OJW8W5GSZJ"},{"type":"outputs","id":"1dG6F_nP8L8IntI2g4BBX","children":[],"key":"YYuFXKcjqR"}],"key":"fWdpSHoPaQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Build the U-net","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PF3QfaHshH"}],"identifier":"id-1-build-the-u-net","label":"1. Build the U-net","html_id":"id-1-build-the-u-net","implicit":true,"key":"WMGEkS2WWQ"}],"key":"DXVFWApkgG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Cell 2: U-Net Building Blocks\nclass ConvBlock(nn.Module):\n    def __init__(self, in_channels, out_channels, kernel_size=3, padding=1):\n        super().__init__()\n        self.conv = nn.Sequential(\n            nn.Conv1d(in_channels, out_channels, kernel_size, padding=padding),\n            nn.ReLU(),\n            nn.Conv1d(out_channels, out_channels, kernel_size, padding=padding),\n            nn.ReLU()\n        )\n\n    def forward(self, x):\n        return self.conv(x)\n\nclass UNet1D(nn.Module):\n    def __init__(self, in_channels=3, out_channels=3, features=[16, 32, 64, 128]):\n        super().__init__()\n        \n        self.downs = nn.ModuleList()  # Encoder blocks (downsampling path)\n        self.ups = nn.ModuleList()    # Decoder blocks (upsampling path)\n    \n        # ----- Encoder: Downsampling Path -----\n        # Each ConvBlock halves the temporal resolution via pooling (done in forward),\n        # and increases the number of feature channels.\n        for feat in features:\n            self.downs.append(ConvBlock(in_channels, feat))  # ConvBlock: Conv + ReLU + Conv + ReLU\n            in_channels = feat  # Update in_channels for the next block\n    \n        # ----- Bottleneck -----\n        # Deepest layer in the U-Net, connects encoder and decoder\n        self.bottleneck = ConvBlock(features[-1], features[-1]*2)\n    \n        # ----- Decoder: Upsampling Path -----\n        # Reverse features list for symmetrical decoder\n        rev_feats = features[::-1]\n        for feat in rev_feats:\n            # First upsample (via transposed convolution)\n            self.ups.append(\n                nn.ConvTranspose1d(feat*2, feat, kernel_size=2, stride=2)\n            )\n            # Then apply ConvBlock: input has double channels due to skip connection\n            self.ups.append(ConvBlock(feat*2, feat))\n    \n        # ----- Final Output Convolution -----\n        # 1x1 convolution to map to desired output channels (e.g., P, S, noise)\n        self.final_conv = nn.Conv1d(features[0], out_channels, kernel_size=1)\n\n    def forward(self, x):\n        skip_connections = []\n\n        for down in self.downs:\n            x = down(x)\n            skip_connections.append(x)\n            x = F.max_pool1d(x, kernel_size=2)\n\n        x = self.bottleneck(x)\n        skip_connections = skip_connections[::-1]\n\n        for idx in range(0, len(self.ups), 2):\n            x = self.ups[idx](x)\n            skip_conn = skip_connections[idx//2]\n            if x.shape[-1] != skip_conn.shape[-1]:\n                x = F.pad(x, (0, skip_conn.shape[-1] - x.shape[-1]))\n            x = torch.cat((skip_conn, x), dim=1)\n            x = self.ups[idx+1](x)\n        x = self.final_conv(x)\n        return F.softmax(x, dim=1)","key":"kRm08L8AOz"},{"type":"outputs","id":"az_paYZOGE-95TYsE2Rzm","children":[],"key":"hEYKwwPOON"}],"key":"e8ZsCqszv3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Load weights into the model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AfyoLXWcNU"}],"identifier":"id-2-load-weights-into-the-model","label":"2. Load weights into the model","html_id":"id-2-load-weights-into-the-model","implicit":true,"key":"p7b4AwTQgV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This cell loads the saved weights into the model.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dWDC7RnZkc"}],"key":"HqyVXUsZ2q"}],"key":"WrQQULKMYz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model = UNet1D()\nmodel.load_state_dict(torch.load(\"../Loic/UNet/model_weights_eq_only_v2.pt\",weights_only=True, map_location=torch.device('cpu')))\nmodel.eval() ","key":"rDyp11lUfY"},{"type":"outputs","id":"yHhzoHchSugAmHJcSrDbM","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/plain":{"content":"UNet1D(\n  (downs): ModuleList(\n    (0): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(3, 16, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(16, 16, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (1): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(16, 32, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (2): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(32, 64, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (3): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n  )\n  (ups): ModuleList(\n    (0): ConvTranspose1d(256, 128, kernel_size=(2,), stride=(2,))\n    (1): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(256, 128, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (2): ConvTranspose1d(128, 64, kernel_size=(2,), stride=(2,))\n    (3): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(128, 64, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (4): ConvTranspose1d(64, 32, kernel_size=(2,), stride=(2,))\n    (5): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(64, 32, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n    (6): ConvTranspose1d(32, 16, kernel_size=(2,), stride=(2,))\n    (7): ConvBlock(\n      (conv): Sequential(\n        (0): Conv1d(32, 16, kernel_size=(3,), stride=(1,), padding=(1,))\n        (1): ReLU()\n        (2): Conv1d(16, 16, kernel_size=(3,), stride=(1,), padding=(1,))\n        (3): ReLU()\n      )\n    )\n  )\n  (bottleneck): ConvBlock(\n    (conv): Sequential(\n      (0): Conv1d(128, 256, kernel_size=(3,), stride=(1,), padding=(1,))\n      (1): ReLU()\n      (2): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,))\n      (3): ReLU()\n    )\n  )\n  (final_conv): Conv1d(16, 3, kernel_size=(1,), stride=(1,))\n)","content_type":"text/plain"}}},"children":[],"key":"X2TvWuOZD0"}],"key":"SY7a35UoW3"}],"key":"AWzVaMk5km"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Load and preprocess MiniSEED waveform data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Aqg4ufwztj"}],"identifier":"id-3-load-and-preprocess-miniseed-waveform-data","label":"3. Load and preprocess MiniSEED waveform data","html_id":"id-3-load-and-preprocess-miniseed-waveform-data","implicit":true,"key":"lUPpFeEgCS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The most important thing here is to make sure that the input data is similar to the training set.  This includes insuring that the sample rates are the same and the same normalizations applied to the preprocessing steps are applied to the actual data.  This includes sample rates, normalizations, and component order.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"npMObna5tF"}],"key":"W4xJEqfoTV"}],"key":"hMqFCvjl91"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load and preprocess MiniSEED waveform data\nimport numpy as np\nfrom obspy import read, Stream, Trace\n\n# the PNW dataset is in ENZ order, if only Z is present, we need to create dummy E and N traces\nfrom obspy import Stream, Trace\nimport numpy as np\n\ndef ensure_ENZ_order(st):\n    \"\"\"\n    Ensure a stream has channels in E, N, Z order.\n    Handles both E/N/Z and 1/2/Z naming conventions.\n    If only Z is present, creates dummy E and N traces filled with zeros.\n    \"\"\"\n    # Normalize component keys (map 1 -> E, 2 -> N, Z stays Z)\n    comp_map = {}\n    for tr in st:\n        suffix = tr.stats.channel[-1].upper()\n        if suffix == \"1\":\n            comp_map[\"E\"] = tr\n        elif suffix == \"2\":\n            comp_map[\"N\"] = tr\n        else:\n            comp_map[suffix] = tr\n\n    print(\"Detected components:\", comp_map.keys())\n\n    # If only Z is present, create dummy E and N\n    if set(comp_map.keys()) == {\"Z\"}:\n        z_trace = comp_map[\"Z\"]\n        npts = z_trace.stats.npts\n        sampling_rate = z_trace.stats.sampling_rate\n        starttime = z_trace.stats.starttime\n\n        # Create dummy E and N traces\n        e_trace = Trace(data=np.zeros(npts, dtype=np.float32), header=z_trace.stats.copy())\n        n_trace = Trace(data=np.zeros(npts, dtype=np.float32), header=z_trace.stats.copy())\n\n        e_trace.stats.channel = z_trace.stats.channel[:-1] + \"E\"\n        n_trace.stats.channel = z_trace.stats.channel[:-1] + \"N\"\n\n        return Stream(traces=[e_trace, n_trace, z_trace])\n\n    # Reorder to E, N, Z (if available)\n    ordered = []\n    for comp in [\"E\", \"N\", \"Z\"]:\n        if comp in comp_map:\n            ordered.append(comp_map[comp])\n\n    return Stream(traces=ordered)\n\n\n\n# Load the data\nst = read('../data/B047.PB.EH*')\n# st = read('../../../shared/shortcourses/crescent_ml_2025/miniseed/B047*')\n# Merge streams\nst.merge(fill_value='interpolate')\n# Ensure ENZ order\nst = ensure_ENZ_order(st)\n# Demean\nst.detrend('demean')\n# Resample to 100 Hz\nfor tr in st:\n    if tr.stats.sampling_rate != 100:\n        print(f\"Resampling {tr.id} from {tr.stats.sampling_rate} Hz to {target_rate} Hz\")\n        tr.resample(target_rate)\n\n# Your input data\ndata = np.stack([tr.data for tr in st], axis=0)  # shape: (channels, time)\nchunk_size = 3001\nnum_channels, total_length = data.shape\n\n# Calculate how much padding is needed\nremainder = total_length % chunk_size\nif remainder > 0:\n    pad_width = chunk_size - remainder\n    # Pad with zeros at the end along the time axis\n    data = np.pad(data, ((0, 0), (0, pad_width)), mode='constant')\n\n# Reshape to (num_chunks, 3, 3001)\nnum_chunks = data.shape[1] // chunk_size\nchunks = data.reshape(num_channels, num_chunks, chunk_size).transpose(1, 0, 2)  # shape: (num_chunks, 3, 3001)\n\n# Demean each chunk along the time axis\nmeans = np.mean(chunks, axis=2, keepdims=True)  # shape: (num_chunks, 3, 1)\ndemeaned_chunks = chunks - means\n\n# Normalize by the peak absolute value \nmax_vals = np.max(np.abs(demeaned_chunks), axis=2, keepdims=True)  # shape: (num_chunks, 3, 1)\nnormalized_chunks = np.divide(\n    demeaned_chunks,\n    max_vals,\n    out=np.zeros_like(demeaned_chunks),\n    where=max_vals != 0\n).astype(np.float32)\n\n# Convert to torch tensor\ninput_tensor = torch.tensor(normalized_chunks, dtype=torch.float32, device=torch.device('cpu'))  # shape: (batch_size, 3, 3001)","key":"XZ3sbgbJbb"},{"type":"outputs","id":"sFFrqP-HTYiDzSuFRYimS","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Detected components: dict_keys(['E', 'N', 'Z'])\n"},"children":[],"key":"DkS1yjjGYZ"}],"key":"x4yTuUqn9N"}],"key":"rPXhSf3iip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Run inference\nwith torch.no_grad():\n    pred = model(input_tensor).squeeze(0).cpu().numpy()  # shape: (2, T)","key":"y9cS1oa2Cz"},{"type":"outputs","id":"Du8iUIoW72HPLU-3r59qY","children":[],"key":"iqEMr6MDHb"}],"key":"GJ84Nk59EY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Step 1: Reshape to (2, total_length_with_padding)\ninput_unwrapped = input_tensor.permute(1, 0, 2).reshape(3, -1)[:, :8640000]   # Shape: (3, num_chunks * 3001)\npred_unwrapped = pred.transpose(1, 0, 2).reshape(3, -1)[:, :8640000]   # shape: (2, num_chunks * 3001)","key":"zXuASodFbX"},{"type":"outputs","id":"HWX-CF3WOfDbfDaMKChtm","children":[],"key":"ntPIvIq5ge"}],"key":"XWOp79Y983"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Write pick file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xj6gVD9J8k"}],"identifier":"id-4-write-pick-file","label":"4. Write pick file","html_id":"id-4-write-pick-file","implicit":true,"key":"x0WeIGFgoj"}],"key":"GCRodPhcr2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Output file\noutput_file = 'detections_%s.%s.%s.%s.csv'%(tr.stats.network,tr.stats.station,tr.stats.starttime.year,tr.stats.starttime.julday)\n\nimport csv\nfrom obspy import UTCDateTime\nfrom scipy.signal import find_peaks\n\n# Example settings (replace with actual values)\nthreshold = 0.1\nstarttime = tr.stats.starttime  # trace start time\n\n# Write header\nwith open(output_file, 'w', newline='') as f:\n    writer = csv.writer(f)\n    writer.writerow(['phase', 'time', 'confidence'])\n\n    for phase_idx, phase_label in enumerate(['P', 'S']):\n        probs = pred_unwrapped[phase_idx, :]\n\n        # Find peaks in the probability curve\n        peaks, properties = find_peaks(probs, height=threshold, distance=tr.stats.sampling_rate)  # e.g. at least 1s apart\n\n        for peak_idx in peaks:\n            peak_time = starttime + peak_idx / tr.stats.sampling_rate\n            confidence = probs[peak_idx]\n            writer.writerow([phase_label, peak_time,f'{confidence:.3f}'])\n\n! head detections*","key":"qCI0E5E0IM"},{"type":"outputs","id":"HartVvrK3TSi_TZevcvyW","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"phase,time,confidence\nP,2022-12-20T00:01:40.038400Z,0.327\nP,2022-12-20T00:01:41.648400Z,0.789\nP,2022-12-20T00:01:45.568400Z,0.642\nP,2022-12-20T00:01:50.978400Z,0.306\nP,2022-12-20T00:01:55.968400Z,0.106\nP,2022-12-20T00:02:06.428400Z,0.342\nP,2022-12-20T00:02:20.758400Z,0.108\nP,2022-12-20T00:02:23.068400Z,0.292\nP,2022-12-20T00:02:30.058400Z,0.279\n"},"children":[],"key":"y5cR4jEJ5y"}],"key":"LcDIdQgkyY"}],"key":"JANaiutQ1w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5. Plot the predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DgP30o8rXH"}],"identifier":"id-5-plot-the-predictions","label":"5. Plot the predictions","html_id":"id-5-plot-the-predictions","implicit":true,"key":"AtrAGCE7N7"}],"key":"HRfns2rawA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"picks","key":"sRzvbZ7tnt"},{"type":"outputs","id":"th4deZyWCUqZn_CKo2fJf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>index</th>\n      <th>phase</th>\n      <th>time</th>\n      <th>confidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>P</td>\n      <td>2022-12-20T00:01:40.038400Z</td>\n      <td>0.327</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>P</td>\n      <td>2022-12-20T00:01:41.648400Z</td>\n      <td>0.789</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>P</td>\n      <td>2022-12-20T00:01:45.568400Z</td>\n      <td>0.642</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>P</td>\n      <td>2022-12-20T00:01:50.978400Z</td>\n      <td>0.306</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>P</td>\n      <td>2022-12-20T00:01:55.968400Z</td>\n      <td>0.106</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4005</th>\n      <td>4005</td>\n      <td>S</td>\n      <td>2022-12-20T23:59:36.108400Z</td>\n      <td>0.445</td>\n    </tr>\n    <tr>\n      <th>4006</th>\n      <td>4006</td>\n      <td>S</td>\n      <td>2022-12-20T23:59:45.758400Z</td>\n      <td>0.241</td>\n    </tr>\n    <tr>\n      <th>4007</th>\n      <td>4007</td>\n      <td>S</td>\n      <td>2022-12-20T23:59:49.668400Z</td>\n      <td>0.946</td>\n    </tr>\n    <tr>\n      <th>4008</th>\n      <td>4008</td>\n      <td>S</td>\n      <td>2022-12-20T23:59:53.888400Z</td>\n      <td>0.205</td>\n    </tr>\n    <tr>\n      <th>4009</th>\n      <td>4009</td>\n      <td>S</td>\n      <td>2022-12-20T23:59:58.898400Z</td>\n      <td>0.398</td>\n    </tr>\n  </tbody>\n</table>\n<p>4010 rows × 4 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"      index phase                         time  confidence\n0         0     P  2022-12-20T00:01:40.038400Z       0.327\n1         1     P  2022-12-20T00:01:41.648400Z       0.789\n2         2     P  2022-12-20T00:01:45.568400Z       0.642\n3         3     P  2022-12-20T00:01:50.978400Z       0.306\n4         4     P  2022-12-20T00:01:55.968400Z       0.106\n...     ...   ...                          ...         ...\n4005   4005     S  2022-12-20T23:59:36.108400Z       0.445\n4006   4006     S  2022-12-20T23:59:45.758400Z       0.241\n4007   4007     S  2022-12-20T23:59:49.668400Z       0.946\n4008   4008     S  2022-12-20T23:59:53.888400Z       0.205\n4009   4009     S  2022-12-20T23:59:58.898400Z       0.398\n\n[4010 rows x 4 columns]","content_type":"text/plain"}}},"children":[],"key":"MVNoGjbHu0"}],"key":"Ei7fzh0TuM"}],"key":"viEyNPe3zG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# Apply bandpass filter to each trace in-place\nst.filter('bandpass', freqmin=1.0, freqmax=20.0, corners=4, zerophase=True)\nplot_data = np.stack([tr.data for tr in st], axis=0)  # shape: (channels, time)\n\n# Assume 100 Hz sampling rate; adjust as needed\nsampling_rate = st[0].stats.sampling_rate\nstart_time = st[0].stats.starttime\n\n# load pick file\npicks=pd.read_csv(output_file)\n\n# Get max amplitude in Z-channel\nmaxind = np.argmax(plot_data[2, :])\nwinlen = 6000  # window length in samples\n\nfor ii in np.arange(maxind // winlen - 1, maxind // winlen + 9):\n    istart = ii * winlen\n    ifinish = istart + winlen\n    if istart < 0 or ifinish > plot_data.shape[1]:\n        continue\n\n    # Compute timestamps for the window\n    window_start_time = start_time + istart / sampling_rate\n    window_end_time = start_time + ifinish / sampling_rate\n\n    # Filter picks by time window\n    mask = (picks['time'] >= window_start_time.datetime) & (picks['time'] < window_end_time.datetime)\n    ppicks_filtered = picks[mask & (picks['phase'] == 'P')]\n    spicks_filtered = picks[mask & (picks['phase'] == 'S')]\n\n    # Convert pick times to sample indices\n    ppick_indices = ((ppicks_filtered['time'] - start_time.datetime).dt.total_seconds() * sampling_rate).astype(int)\n    spick_indices = ((spicks_filtered['time'] - start_time.datetime).dt.total_seconds() * sampling_rate).astype(int)\n\n    # Plotting\n    fig, axs = plt.subplots(2, 1, figsize=(15, 6), sharex=True)\n    \n    axs[0].set_title('Input Seismic Data')\n    axs[0].plot(plot_data[0, istart:ifinish], label='E-component', color='tab:red')\n    axs[0].plot(plot_data[1, istart:ifinish], label='N-component', color='tab:grey')\n    axs[0].plot(plot_data[2, istart:ifinish], label='Z-component', color='tab:blue')\n    axs[0].legend()\n\n    axs[1].set_title('Prediction')\n    # If you have predictions:\n    # axs[1].plot(pred_unwrapped[0, istart:ifinish], label='P-phase', color='tab:red')\n    # axs[1].plot(pred_unwrapped[1, istart:ifinish], label='S-phase', color='tab:blue')\n    # axs[1].plot(pred_unwrapped[2, istart:ifinish], label='Noise', color='tab:grey')\n\n    axs[1].plot(ppick_indices - istart, ppicks_filtered['confidence'], 'o', color='tab:red', label='P-pick')\n    axs[1].plot(spick_indices - istart, spicks_filtered['confidence'], 'o', color='tab:blue', label='S-pick')\n    axs[1].legend()\n\n    plt.tight_layout()\n    plt.show()\n","key":"Y696q6XRxz"},{"type":"outputs","id":"a3fiBypWDoiqzbC4DNSQE","children":[{"type":"output","jupyter_data":{"ename":"TypeError","evalue":"'>=' not supported between instances of 'str' and 'datetime.datetime'","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mTypeError\u001b[39m                                 Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[89]\u001b[39m\u001b[32m, line 29\u001b[39m\n\u001b[32m     26\u001b[39m window_end_time = start_time + ifinish / sampling_rate\n\u001b[32m     28\u001b[39m \u001b[38;5;66;03m# Filter picks by time window\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m29\u001b[39m mask = (\u001b[43mpicks\u001b[49m\u001b[43m[\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mtime\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m \u001b[49m\u001b[43m>\u001b[49m\u001b[43m=\u001b[49m\u001b[43m \u001b[49m\u001b[43mwindow_start_time\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdatetime\u001b[49m) & (picks[\u001b[33m'\u001b[39m\u001b[33mtime\u001b[39m\u001b[33m'\u001b[39m] < window_end_time.datetime)\n\u001b[32m     30\u001b[39m ppicks_filtered = picks[mask & (picks[\u001b[33m'\u001b[39m\u001b[33mphase\u001b[39m\u001b[33m'\u001b[39m] == \u001b[33m'\u001b[39m\u001b[33mP\u001b[39m\u001b[33m'\u001b[39m)]\n\u001b[32m     31\u001b[39m spicks_filtered = picks[mask & (picks[\u001b[33m'\u001b[39m\u001b[33mphase\u001b[39m\u001b[33m'\u001b[39m] == \u001b[33m'\u001b[39m\u001b[33mS\u001b[39m\u001b[33m'\u001b[39m)]\n\n\u001b[36mFile \u001b[39m\u001b[32m~/anaconda3/envs/pytorch/lib/python3.12/site-packages/pandas/core/ops/common.py:76\u001b[39m, in \u001b[36m_unpack_zerodim_and_defer.<locals>.new_method\u001b[39m\u001b[34m(self, other)\u001b[39m\n\u001b[32m     72\u001b[39m             \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mNotImplemented\u001b[39m\n\u001b[32m     74\u001b[39m other = item_from_zerodim(other)\n\u001b[32m---> \u001b[39m\u001b[32m76\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mmethod\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mother\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/anaconda3/envs/pytorch/lib/python3.12/site-packages/pandas/core/arraylike.py:60\u001b[39m, in \u001b[36mOpsMixin.__ge__\u001b[39m\u001b[34m(self, other)\u001b[39m\n\u001b[32m     58\u001b[39m \u001b[38;5;129m@unpack_zerodim_and_defer\u001b[39m(\u001b[33m\"\u001b[39m\u001b[33m__ge__\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m     59\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m__ge__\u001b[39m(\u001b[38;5;28mself\u001b[39m, other):\n\u001b[32m---> \u001b[39m\u001b[32m60\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_cmp_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mother\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moperator\u001b[49m\u001b[43m.\u001b[49m\u001b[43mge\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/anaconda3/envs/pytorch/lib/python3.12/site-packages/pandas/core/series.py:6119\u001b[39m, in \u001b[36mSeries._cmp_method\u001b[39m\u001b[34m(self, other, op)\u001b[39m\n\u001b[32m   6116\u001b[39m lvalues = \u001b[38;5;28mself\u001b[39m._values\n\u001b[32m   6117\u001b[39m rvalues = extract_array(other, extract_numpy=\u001b[38;5;28;01mTrue\u001b[39;00m, extract_range=\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[32m-> \u001b[39m\u001b[32m6119\u001b[39m res_values = \u001b[43mops\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcomparison_op\u001b[49m\u001b[43m(\u001b[49m\u001b[43mlvalues\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrvalues\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mop\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   6121\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m._construct_result(res_values, name=res_name)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/anaconda3/envs/pytorch/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:344\u001b[39m, in \u001b[36mcomparison_op\u001b[39m\u001b[34m(left, right, op)\u001b[39m\n\u001b[32m    341\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m invalid_comparison(lvalues, rvalues, op)\n\u001b[32m    343\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m lvalues.dtype == \u001b[38;5;28mobject\u001b[39m \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(rvalues, \u001b[38;5;28mstr\u001b[39m):\n\u001b[32m--> \u001b[39m\u001b[32m344\u001b[39m     res_values = \u001b[43mcomp_method_OBJECT_ARRAY\u001b[49m\u001b[43m(\u001b[49m\u001b[43mop\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlvalues\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrvalues\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    346\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    347\u001b[39m     res_values = _na_arithmetic_op(lvalues, rvalues, op, is_cmp=\u001b[38;5;28;01mTrue\u001b[39;00m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/anaconda3/envs/pytorch/lib/python3.12/site-packages/pandas/core/ops/array_ops.py:129\u001b[39m, in \u001b[36mcomp_method_OBJECT_ARRAY\u001b[39m\u001b[34m(op, x, y)\u001b[39m\n\u001b[32m    127\u001b[39m     result = libops.vec_compare(x.ravel(), y.ravel(), op)\n\u001b[32m    128\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m129\u001b[39m     result = \u001b[43mlibops\u001b[49m\u001b[43m.\u001b[49m\u001b[43mscalar_compare\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m.\u001b[49m\u001b[43mravel\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mop\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    130\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m result.reshape(x.shape)\n\n\u001b[36mFile \u001b[39m\u001b[32mops.pyx:107\u001b[39m, in \u001b[36mpandas._libs.ops.scalar_compare\u001b[39m\u001b[34m()\u001b[39m\n\n\u001b[31mTypeError\u001b[39m: '>=' not supported between instances of 'str' and 'datetime.datetime'"},"children":[],"key":"nxH7zujJQr"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"Bad pipe message: %s [b'\\x13\\xcb\\x057\\x9b\\xa8\\xde\\x00\\x95\\x15...","hash":"61ca22687efad13ff97867467ff757c6","path":"/61ca22687efad13ff97867467ff757c6.txt"},"children":[],"key":"BO12K9nVNn"}],"key":"dNFAgIhQR0"}],"key":"ZOY26edh9Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start","key":"lb2PNsR6mx"},{"type":"outputs","id":"SdLr4Mrs_vYv_b-dsWUaN","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":82,"metadata":{},"data":{"text/plain":{"content":"76062.09","content_type":"text/plain"}}},"children":[],"key":"klYkGthL59"}],"key":"SzS2XW1nla"}],"key":"MwZjxwO8pX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"picks.loc[0,'time']\n","key":"iU3SXF39vS"},{"type":"outputs","id":"zrIm24nTpJiVCn0gJqXGG","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"Timestamp('2022-12-20 00:01:40.038400+0000', tz='UTC')","content_type":"text/plain"}}},"children":[],"key":"L7wig2PmSM"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"Bad pipe message: %s [b'\\x03\\xac\\xa2\\xf2\"\\xb2\\xbf\\xd6P\\xff-\\x19\\xe3\\xe5X\\x92U\\xa1 \\xa8h\\x1d!\\x139`n\\x1d\\xed^ \\xc6\\xa2\\xe2\\xb2Rd\\x8e\\x12_8\\x8a\\xa1\\xf2\\xd8z\\x86Pb\\xb8\\x82\\x00 ::\\x13\\x01\\x13\\x02\\x13\\x03\\xc0+\\xc0/\\xc0,\\xc00\\xcc\\xa9\\xcc\\xa8\\xc0\\x13\\xc0\\x14\\x00\\x9c\\x00\\x9d\\x00/\\x005\\x01\\x00\\x06S\\xba\\xba\\x00\\x00\\x00+\\x00\\x07\\x06\\xda\\xda\\x03\\x04\\x03\\x03\\x00#\\x00\\x00\\x00\\n\\x00\\x0c\\x00\\n**\\x11\\xec\\x00\\x1d\\x00\\x17\\x00\\x18\\x00\\x1b\\x00\\x03\\x02\\x00\\x02\\x00\\r\\x00\\x12\\x00\\x10\\x04\\x03\\x08\\x04\\x04\\x01\\x05\\x03\\x08\\x05\\x05\\x01\\x08\\x06\\x06\\x01\\xfe\\r\\x00\\xda\\x00\\x00\\x01\\x00\\x01V\\x00 % \\xbd\\x19\\xa2\\x94l\\xc0\\x0eUQ\\x88\\x89\\xe3o$\\xcc\\x19\\xbc\\x05\\x00\\xee*\\xdf\\xba1\\x02\\xca\\xda\\x86\\x89B\\x00\\xb0\\x1c', b'%\\xe4\\xc9T\\xa3\\xa1\\xdb\\xa6\\x15\\xfe\\xfa\\x9d\\xd8p\\xd5\\xea#\\x11i\\x99?7\\xc4\\x94\\xc6\\xa9\\xca\\xc6\\x08IE/T\\xac\\x15\\xd4\\xa6\\xe5$\\xdb\\xda\\xf9.X[\\xdc\\xb6\\x0b\\x08\\xa1`n\\xf8\\x89\\x80\\x03dQ\\xa6\\x1f\\xc2R\\x0e\\xc8C\\xfe,\\xc3\\xff\\x8d\\xc5\\xe3\\xb2\\xf2K\\xe1[\\x80=\\xc7\\x00\\x85Y\\x97.B1\\xc5\\xa6\\xce{\\xbe\\x19\\xc6\\xdc\\xf1)L\\xa1\\xe9\\x8e\\xeb\\xde\\xac\\xb3\\x19-F\\x849\\xbe\\xc6P\\xeaN_n\\xcd\\x9f\\xa7\\x82\\x01\\x96\\xae\\x03\\x965q\\xbe\\xd9hV\\x1bAj\\xa2p_crr\\xe5', b\"\\xd8\\xd6\\x00\\x0b%V\\na\\x85R0vZ\\x88v\\xd8\\xcb\\x17\\t\\xadK\\xc8:\\x1b\\xb1\\x1c\\xed\\x12\\xe9D\\xcd\\x00\\x05\\x00\\x03\\x02h2\\x00\\x12\\x00\\x00\\x00\\x17\\x00\\x00\\x00-\\x00\\x02\\x01\\x01\\x00\\x0b\\x00\\x02\\x01\\x00\\x00\\x05\\x00\\x05\\x01\\x00\\x00\\x00\\x00\\xff\\x01\\x00\\x01\\x00\\x003\\x04\\xef\\x04\\xed**\\x00\\x01\\x00\\x11\\xec\\x04\\xc0\\xc2K\\x07L\\xb05\\xf3\\xaa\\x7fT\\x05\\xa2 \\x89\\x1a\\xbcC\\x90>H\\x9ad\\xa5\\xc5EI=t'~\\xdc,V\\x06\\x0b<\\xe1t\\x98\\x15lQx\\x86\\x16w\\xe1=\\xe9\\x98E\\xfaTN3\\xd5\\xbf\\xe5\\x95\\xcc*\\xa3\\xa3\\xaa\\xbc\\x0f\\xb6\\xc0\\xa6B\\x90\\x8a[\\\\\\x81.\\xf3w0\\xf7\\x9dC\\xd2S\\x11\\xc3\\x15\\x18\\xf9\\x81\\xed\\xe0\\xb7}5v\\xbd\\nq\\xbc\\x8b\\xa5\\xaf\\xa7s4\\xc4=L\\x8a]\\x8b\\xe0e\\x0e\\xe4^\\xbf\\xbc\\x02o\\xd7#\\xe4\\xe7G\\x11kq\\x9a\\xe8\\xc1\\x0c\\xab\\x9b\\xdbT\\x81\\xa2$i\\x05\\x88\\x80\\x92\\xf1\\x9fk%\\x90D\", b'\\x05\\xca\\x8f?\\xa5R\\x83)?\\xb2\\x95\\x7f\\xc3\\xe5\\\\\\'wP=\\xeb\\x93h\\x1c\\x8c\\xf0\\xcc.\\x05\\xd0\\x7f\\xacV\\xca?\\xda\\x1a\\xf2h\\x98\\xa6\\x03\\x00 \\xb1\\xa2G\\xa2\\x10}\\xd5F~R\\x15\\xe7Q\\xb6R\\x8a\\xbfuUX\\xdb+\\x0b{9E\"\\xab\\xccm\\xc9\\x03BV\\xc9\\x8fQ\\x03\\x8f\\xd2`\\x98t\\xcd\\xec\\xa2\\xa3\\xbe\\x8aBj\\xf7\\xb6\\xa4\\xec\\x0e\\xb3\\x93`\\xb9PW\\xa5JE\\x02s\\x81&\\xec1\\x92L=q\\t\\xcfpQ\\x06\\xc1\\xd2\\xce\\x00\\xa6\\x9bg\\xd2\\x1e3\\xeaY?4I\\xd5\\xf8\\x9b\\xc0\\x87>\\xd2\\xc4\\xc9`@\\x14\\xfa\\xd7']\nBad pipe message: %s [b'\\xc5\\xb8\\xd8\\xd0\\xd9a\\x17\\xa4\\x12\\x01\\x81\\xcegq\\xbfCDV R2A\\xe0z\\xe1\\xfe\\x184\\xfcqd8\\rQd\\xd2+\\x9d\\xae\\x9b\\x1d0\\x1f\\xb0\\x04\\xdb\\x17\\x95\\xecd\\xb2\\x00 zz\\x13\\x01\\x13\\x02\\x13\\x03\\xc0+\\xc0/\\xc0,\\xc00\\xcc\\xa9\\xcc\\xa8\\xc0\\x13\\xc0\\x14\\x00\\x9c\\x00\\x9d\\x00/\\x005\\x01\\x00\\x06s\\x9a\\x9a\\x00\\x00\\x00\\x05\\x00\\x05\\x01\\x00\\x00\\x00\\x00\\x00\\r\\x00\\x12\\x00\\x10\\x04\\x03\\x08\\x04\\x04\\x01\\x05\\x03\\x08\\x05\\x05\\x01\\x08\\x06\\x06\\x01\\x003\\x04\\xef\\x04\\xed\\xaa\\xaa\\x00\\x01\\x00\\x11\\xec\\x04\\xc0g$W\\xbcb`X\\xacn\\xc4\\'C\\xb2\\xb4\\xc5u\\x93\\x8f\\x94<i\\x16\\xb9\\xb5\\x03kI7(\\xb0\\x91\\x96\\xba\\xb1\\x12R\\x1c\\xcasd\\xb2=^\\xccc\\xaf\\xc4LYW;/E[\\x0e\\xe89\"\\xbal\\xb2\\xac5z\\x06s\\xf8b\\x03\\x88\\x90\\xc3\\xf5\\xa0\\x01\\xb5\\x18\\x86\\n\\x91T\\xb7\\xa3\\\\\\n(\\xa0;#/6\\xd8fgI\\x00\\xe5\\x0b\\xa0\\xd5\\x88>', b'>\\xc9\\x1a\\xcbUr\\x94GK\\x84\\xcf', b'\\xb4\\x85\\x8af:\\x1f\\xad\\x8c:\\xd5\\x80.\\x83x;eA\\xc3f9\\xb4\\x88\\x07\\xb1\\xee\\xe3#\\x9b%m6\\xa8\\xc5\\xfb\\xd0\\x99\\xc5\\xc4\\xc4GJRu\\x03\\x91/\\x93\\x83\\x84\\xc1\\x9ef&\\x10\\xa7\\n0\\xb6iE\\xd1\\xdbn\\xef\\xf5k@\\'\\x9a\\x17\\x91\\x0b[T\\x11.\\xac\\x02\\xa7\\xdc%\\xea\\x114\\x8f8\\xb2\\x01rZ\\xa92\\\\b4\\x93\\x8e\\x93\\xa6i\\x86\\xcc6 \\x96\\x89\\x85\\x8el\\xf9\\x87\\xa0#&\\x9e\\xa2\\x83e3\\xa7s\\'\\x92\\x86\\x82\\x0c\\xf9\\xebC.\\xc0\\xb2~\\\\\\x84\\xb9\\xa7\\x0c\\x05h$Q\\'T\\x98\\x9bC\\x93\"=\\xcaG\\x0c\\xff\\xa2\\xc9\\xb3\\x17{]\\x90\\xac\\x13)A\\nC\\x85\\xd5[\\xba)\\xca\\xa4\\xc5\\xf0\\x80 4\\xb0\\xdb\\xea\\xcb\\x91V\\x16\\x82F\\x81\\xaa1\\xad\\xd9u\\x15\\x06$3\\xa8\\xf8p\\xb4\\x1a4\\xfc\\tIi', b'\\xc5\\x82\\x87\\x9f\\x999@\\xc1\\xce\\x85\\xf6\\xa78\\tUN\\x04{\\xdarO\\x8a\\xd1t\\x15\\xe3\\x02*\\x0b\\xc1!bv\\xa7\\xea\\x81\\xcf\\x00Gf{p\\x19,~\\x1e\\xdb\\xc4\\xc9\\xfc\\x1f\\xd4\\t\\nB\\xb5P12/i\\xf2\\x06\\x8c\\xf4\\x84\\xe9\\x951\\xcbZ\\x8dQ\\xa7-\\xff\\xca\\x1ez\\xcbi\\xa0\\x94`@2\\x1d\\xb0\\xc0\\x8a\\x05*\\xcbB\\x13\\xa3\\x87\\xa7\\xa8\\xef\\n\\x1f\\xe3\\x801-\\xdc\\xc5\\x1d\\x98K-\\xb9\\xc7\\xa9\\xd1Yz\\xaas(WZ\\xff\\x8b\\xcd4*\\x0c\\xcf\\x84\\xbbYG\\x82\\xd7\\x88\\x84\\xd4U\\x94k\\xc7M\\xb6\\x8cl\"\\xac9\\xdf\\x99\"\\xe6\\xba\\x08\\x90\\xfc\\x85w\\xaa*\\xb0\"x^\\x00\\xb3:9<!\\xfc\\xceC\\xe0\\x96)bhJ\\xdc\\xc9\\xb5\\xfcm3\\x9ac*\\xf0\\xcc&\\xe2{E\\x94Y']\nBad pipe message: %s [b'\\xfb\\x0e\\xca\\xa9\\xbf4\\x03\\x8e\\xcc\\xb7$\\xdc\"*\\x9czZ\\xf9\\xc7\\xc8\\xec\\xfbU\\x07\\t\\x0f\\x88\\x94\\\\\\x00\\xe9{\\xfb\\xcc\\xc8\\n\\xe7\\xce\\xcc']\nBad pipe message: %s [b\"\\x92f\\xe3\\x0b\\x93\\xe2+v\\x02\\x03\\x18\\x80\\x1a\\xc4\\xa8\\x847\\xebf\\xf1y\\x84\\xd8\\xf9\\r\\x00\\xac\\xbfrU[\\x80\\xc0Jl\\x06\\x8a~\\xc8\\xa2\\xb6f\\xa5\\xb8\\xe4C\\x91\\xdb\\x88+\\x01\\x11\\xf7\\x92\\x8d\\xf3I\\x0e\\x971\\xb1\\xa7\\xa6),l\\x8d\\x8b\\xb6\\x02\\xe7Dp\\xd2\\xfbB\\xc3u\\x0f\\xd5T\\xb5}\\x82bp\\x82]A\\xc3,t\\xfc\\x95pX\\x93bG\\xa07\\xe5\\xbf\\x94J\\x07\\x05\\xf4\\xa7\\xc27/\\xbe\\xa7Yv\\xc1:\\xf4\\xc3a\\x96c\\x1c\\x88\\xe4\\xa90\\x1c\\xc2\\xa6\\xf9\\xa6\\x06\\x900g\\xa1NW\\xe8-\\xf3\\x80]\\x9b\\xd0\\x8d\\xad\\xe4!\\xf3\\xa3+\\\\6\\x91\\x13;'\\x8a\\x05,\\x89\\xe4\\x8bE\\xda\\\\\\xe5\\xf2!y\\nW{\\xd1\\x81zy\\xca\\xc0h`q\\xfcR\\xb6\\xa4wa\\xa1kU\\xda\\x1c{U\\xc1\\xee!\\xcam\\x07\\nf\\\\\\xbb\\x18\\xc6\\x16\\x83;L;y%\\x97\\x88j\\x0e\\xa9\\x1a\\xab\\x05:\\\\\\xc7\\x9c\\x9f\\x97\\x1e\\xc4\\xb5\\x15\\x92s\\x02\\xb8\\xf82k\\xebQ\", b'\\x1e<\\xdc\\x03\\xcc\\x11\\xb6c\\x10\\xad\\xf9\\xd5uN\\xec7\\x1cE\\x07]\\xc2\\x07k\\xb1\\x14\\xd6\\xa6=\\xfb\\xc6\\x9d\\x1f%\\xa2b\\xb3n\\xfb\\xdc\\x8f\\x94A\\xcb\\x9f\\xd6R\\x96j\\x12\\xd4{\\x13\\xa1\\x80\\xa8\\xf6\"\\xae\\x95\\xa9EA\\xcb\\xaa\\x15\\x9a\\xb0\\xb2\\xc6q\\x12\\xcb4\\x190\\xb9b\\xb8\\x00\\x00\\x10\\x8a\\x80\\x9c\\x03?6\\xca\\x07\\xaa\\x02\\x1b\\xbc\\xb7\\xfd\\x8aZ\\xc2S\\x7f0{*\\x94\\xc3\\xbb\\xbc\\xf8\\xc5\\x83s~S5O{\\xfb\\xb3\\xbb\"RJ\\xa5\\x81\\xd6\\xac\\x1e\\xb9s\\x17\\x98q\\x03F\\xb4z\\xfc\\x92K\\x06,\\xb5(\\xf4\\xa2\\x8b\\x86\\xa9\\xdf\\xf1sL\\xa4PZ\\xf2&+p\\\\\\xf3\\xb6UIhc\\xffH\\x08\\x8es#\\x00\\xd6y\\x00\\x15C\\x16\\xc4']\nBad pipe message: %s [b'\\xeepT\\xf7:Q\\xa7<B\\xc4\\xbbx\\xd0L\\xc9\\xd8\\xf8\\xcdY!\\x04\\x87Dyv\\x90\\x0f\\xb4s :\\x98\\xbb\\xe77qm\\x89\\x80\\x96\\xd4\\x05\\xafll<\\xfa\\x14\\x88\\x05WRkn9\\x1a\\x15\\xd5\\x0b\\xc2\\x84\\x14V\\xf3\\xc3\\x05\\xb81\\x01\\x85 \\x9dN\\x04u\\xf7Zy\\xe2+\\x15\\xd6\\x0c\\x08&\\x88$\\x9d\\xc4\\xc8|\\xc89\\xa5p\\xb0.\\x05%\\x9dQM]c\\x93\\x9c\\x96']\nBad pipe message: %s [b'\\xe2l\\xaaq]\\xf5\\'\\x8eY\\xb5\\x86\\xd8\"\\xa1b\\x0c\\x05\\xda\\x12W\\x0b#<\\xa3b\\xc2,\\xd1&\\x06R!\\xb5\\xa9\\xa1\\xd0\\xb3\\xb2\\x9f\\xa2\\x8b0`\\xb0\\x81\\xa3\\xc0\\xbf#]\\xfb\\x01C!\\xa8\\xcd\\x1d\\x9b\\xbeZa\\xbd\\xd1\\x9cx\\x0f\\x18.\\xc6\\x84\\x9f\\xc4\\x93\\xa0\\xd0\\x96\\x02\\x8d\\x98j\\xa5H\\x86nu\\xa4D s\\xd8\\xa5\\xa5~\\x15\\x85\\x88y\"\\xdb4\\x06\\xf8iB$\\xb1m\\xf4\\xdc\\xa8\\xcd\\xe5w\\xe9LE\\x8e\\x89\\x03\\xe6\\xac5ST\\x15\\r\\xbb\\x99\\xdd\\xe3lV\\x83H8</}a\\xc8gZ\\x80\\xd6\\xa21\\x06\\xc0\\xc4\\x03\\xd4m\\xc2v\\xc7e;}h)\\xc2\"\\xb0d\\xe3U\\x91usQNv`\\x80d\\xa1HB=W\\xf8\\x17\\xd6\\xf9\\xa2(\\x9bx']\nBad pipe message: %s [b';\\x84\\xd4p\\xc0!\\x80\\xcd\\xec\\x8e9k[1\\x98\\nE\\x84\\x14\\xae\\n\\xa3\\x05\\x03\\xa1\\xe8\\x87s\\xb6{\\x8c\\xa5\\xe8wu,\\xcb\\xaa\\xb9\\t\\x17b\\x19\\xc4\\xd10\\xa2W\\xb6\\xd2t\\r5\\x0c\\xaet\\xf8\"\\x81W\\x16\\x95\\xe5\\x10|\\x82Pn\\xbc\\xc5@@d\\xd6\\xf8Z/\\xd5A\\xc1\\x93\\x00\\xc9\\xe1\\xb0j\\xd3:\\xc0I\\xa9\\xf1\\x85\\x06\\x8c\\xc8\\x96\\x04\\xc9\\x7fJ\\x07X\\xae\\x99\\x9bTT:\\x92%\\xbeTC\\x0c\\x05a1T\\xbaZ\\xb5\\t\\xab\\xdey\\xaa}\\x93\\xc8\\x18`V\\x12d|Xi\\x8c\\x19\\xe5E\\xc5\\x00\\x16\\x06\\xc9qU\\xa9.Z\\x03\\xa4{\\x9c+2\\xc7j(C\\xb1A\"Q\\x88x4\\xe7F;\\xbbC\\x01\\x01T\\x982\\xf3K\\xd2\\x0cokt`\\xdaL\\x18\\xbf\\xe2|\\xbe\\xfbJ\\x03d\\xa1\\xc9a\\xb6']\nBad pipe message: %s [b\"\\x86\\xea\\xcb'\\xd1\\x96\\xa0\\xcd\\xa4\\x89\\xc1\\xd3l\\x06i\\x14\\xe9wh\\xea\\\\Ip\\xe8]\\xc2\\xd3\\xcb\\x82B-AI3\\xe6L\\x89]sR\\xdb\\x0cyZ\\xea\\xa1\\x8db\\xc3\\xbf\\x9cB\\r\\xc9y\\x9c%>\\xf8\\x9ca\\xa8R\\x95\\xcc\\xb2\\x9e\\xcf\\xea+\\xacw7\\xc3\\x91\\x0b\\xef\\x01\\xc9b\\x89\\xac9\\x18L-\\xe6\\xad\\xeb\\x97\"]\nBad pipe message: %s [b'\\xe6%\\x1d:\\xc4\\x97\\xe6%&\\x8a(~\\xd3)H\\xf6\\x88Pd\\x89\\x17\\tf^7X\\x96V)\\xe3\\xa77\\xbeyW\\xb7J\\xbb\\x9b\\x16\\x10\\x87v\\x18+J\\x0c\\x97q\\xac\\xc5\\x1ahR\\xb0@y\\xb2']\nBad pipe message: %s [b'\\xe2P\\xab`\\xc2\\x93c\\xca}\\x9a\\x7f\\x9b\\xf7\\x8c\\x07\\x15\\x19\\rYxe\\x85']\n"},"children":[],"key":"BXx1vG97A8"}],"key":"Xqpp4RDxUt"}],"key":"rFaxCPu4Nq"}],"key":"D2V7tGX9GY"},"references":{"cite":{"order":[],"data":{}}}}